import*as e from"cheerio";import t from"form-data";import i from"axios";import{randomUUID as r}from"node:crypto";import o from"yt-search";import s from"stream";import n from"zlib";import a from"buffer";import d from"crypto";import h from"events";import l from"https";import c from"http";import u from"net";import f from"tls";import m from"url";function p(e,t,i,r){return new(i||(i=Promise))((function(o,s){function n(e){try{d(r.next(e))}catch(e){s(e)}}function a(e){try{d(r.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(n,a)}d((r=r.apply(e,t||[])).next())}))}function _(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,i=e[Symbol.asyncIterator];return i?i.call(e):(e=_(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(i){t[i]=e[i]&&function(t){return new Promise((function(r,o){(function(e,t,i,r){Promise.resolve(r).then((function(t){e({value:t,done:i})}),t)})(r,o,(t=e[i](t)).done,t.value)}))}}}"function"==typeof SuppressedError&&SuppressedError;var y=Object.freeze({__proto__:null,Kuronime:
/**
 * Scraped By Kaviaann
 * Protected By MIT LICENSE
 * Whoever caught removing wm will be sued
 * @description Any Request? Contact me : vielynian@gmail.com
 * @author Kaviaann 2024
 * @copyright https://whatsapp.com/channel/0029Vac0YNgAjPXNKPXCvE2e
 */
class{constructor(){this.BASE_URL="https://kuronime.me"}search(e){return p(this,void 0,void 0,(function*(){return new Promise(((t,r)=>p(this,void 0,void 0,(function*(){try{const o=yield i.post(this.BASE_URL+"/wp-admin/admin-ajax.php",new URLSearchParams({action:"ajaxy_sf",sf_value:e,search:"false"}),{headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36","x-requested-with":"XMLHttpRequest","sec-ch-ua":'"Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"',origin:this.BASE_URL}}).then((e=>e.data)).then((e=>{var t;return null===(t=e.anime)||void 0===t?void 0:t[0]}));if(!o)return r("Query Not Found");if(o.result=yield Promise.all(o.all.map((e=>p(this,void 0,void 0,(function*(){var t,i,r,o;delete e.post_image_html;try{for(var s,n=!0,a=v(Object.keys(e));!(t=(s=yield a.next()).done);n=!0){o=s.value,n=!1;let t=o;t.includes("post_")?(e[t.replace("post_","")]=e[t],delete e[t]):"ID"===t&&(e[t.toLocaleLowerCase()]=e[t],delete e[t])}}catch(e){i={error:e}}finally{try{n||t||!(r=a.return)||(yield r.call(a))}finally{if(i)throw i.error}}return e}))))),delete o.all,delete o.template,delete o.title,delete o.class_name,!o.result.length)return r("Anime Not Found");o.total=o.result.length,o.query=e,t(o)}catch(e){r(e)}}))))}))}detail(t){return p(this,void 0,void 0,(function*(){return new Promise(((r,o)=>p(this,void 0,void 0,(function*(){var s,n,a,d;try{if(!/kuronime\.\w+\/anime/i.test(t))return o("Enter valid kuronime URL!");const h=yield i.get(t,{headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36"}}).then((e=>e.data)).then((t=>e.load(t))),l=h("body").find(".postbody > article"),c={title:h(l).find('.info-header > h1[itemprop="name"]').text().trim(),thumbnail:(null===(n=null===(s=h(l).find(".entry-content > .main-info > .con > div.l > img").attr("data-src"))||void 0===s?void 0:s.split("?"))||void 0===n?void 0:n[0])||"",trailer:h(l).find(".trailer").find("iframe").attr("data-src")||"",id:(null===(a=l.attr("id"))||void 0===a?void 0:a.replace("post-",""))||"",synops:h(l).find(".main-info > .con > .r > .conx > .const").text().trim(),author:h(l).find('.info-header > .year > [itemprop="author"]').text().trim(),updated:h(l).find(".info-header > .year span.updated").text().trim(),views:h(l).find(".tab > .tabx > div.post-views > .post-views-count").text().trim(),followers:null===(d=h(l).find(".main-info > .con > .r > .conx > .rt > .bmc").text().trim())||void 0===d?void 0:d.split(" ")[1],rating:h(l).find(".main-info > .con > .r > .conx > .rt > .rating > strong").text().trim().split(" ")[1],detail:h(l).find(".infodetail > ul > li").map(((e,t)=>({name:h(t).find("b").text().trim().toLowerCase().replace(" on",""),data:h(t).text().trim().replace(h(t).find("b").text().trim()+": ","")}))).get(),episode:h(l).find(".bxcl > ul > li").map(((e,t)=>({title:h(t).find(".lchx > a").text().trim(),link:h(t).find(".lchx > a").attr("href")||""}))).get()};r(c)}catch(e){o(e)}}))))}))}},Samehadaku:
/**
 * Scraped By Kaviaann
 * Protected By MIT LICENSE
 * Whoever caught removing wm will be sued
 * @description Any Request? Contact me : vielynian@gmail.com
 * @author Kaviaann 2024
 * @copyright https://whatsapp.com/channel/0029Vac0YNgAjPXNKPXCvE2e
 */
class{constructor(){this.BASE_URL="https://samehadaku.email"}search(t){return p(this,void 0,void 0,(function*(){return new Promise(((r,o)=>p(this,void 0,void 0,(function*(){try{const s=yield i.get(this.BASE_URL+"/?"+new URLSearchParams({s:t}));if("OK"!==s.statusText)return o("Fail Fetching");const n=e.load(s.data);if(n("main#main").find(".notfound").length)return o("Query Not Found");const a=[];n("main#main").find("article.animpost").each(((e,t)=>{var i,r;a.push({title:null===(i=n(t).find("img").attr("title"))||void 0===i?void 0:i.trim(),id:(null===(r=n(t).attr("id"))||void 0===r?void 0:r.split("-")[1])||"",thumbnail:n(t).find("img").attr("src")||"",description:n(t).find("div.ttls").text().trim(),genre:n(t).find("div.genres > .mta > a").map(((e,t)=>n(t).text().trim())).get(),type:n(t).find("div.type").map(((e,t)=>n(t).text().trim())).get(),star:n(t).find("div.score").text().trim(),views:n(t).find("div.metadata > span").eq(2).text().trim(),link:n(t).find("a").attr("href")||""})})),r(a)}catch(e){o(e)}}))))}))}latest(){return p(this,void 0,void 0,(function*(){return new Promise(((t,r)=>p(this,void 0,void 0,(function*(){try{const o="https://samehadaku.email/anime-terbaru/",s=yield i.get(o,{headers:{"user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36"}});if("OK"!==s.statusText)return r("Website Down");const n=e.load(s.data),a=n("div.post-show > ul").children("li"),d={total:0,anime:[]};for(let e of a)d.anime.push({title:n(e).find("h2.entry-title").text().trim().split(" Episode")[0],thumbnail:n(e).find("div.thumb > a > img").attr("src")||"",postedBy:n(e).find('span[itemprop="author"] > author').text().trim(),episode:n(e).find("span").eq(0).find("author").text().trim(),release:n(e).find('span[itemprop="author"]').next().contents().eq(3).text().split(": ")[1].trim(),link:n(e).find("a").attr("href")||""});d.total=d.anime.length,t(d)}catch(e){r(e)}}))))}))}release(){return p(this,void 0,void 0,(function*(){return new Promise(((e,t)=>p(this,void 0,void 0,(function*(){var r,o,s,n;try{const t={sunday:[],monday:[],tuesday:[],wednesday:[],thursday:[],friday:[],saturday:[]};try{for(var a,d=!0,h=v(Object.keys(t));!(r=(a=yield h.next()).done);d=!0){n=a.value,d=!1;let e=n;const r=yield i.get(this.BASE_URL+"/wp-json/custom/v1/all-schedule?"+new URLSearchParams({perpage:"20",day:e,type:"schtml"})).then((e=>e.data));t[e]=r}}catch(e){o={error:e}}finally{try{d||r||!(s=h.return)||(yield s.call(h))}finally{if(o)throw o.error}}e(t)}catch(e){t(e)}}))))}))}detail(t){return p(this,void 0,void 0,(function*(){return new Promise(((r,o)=>p(this,void 0,void 0,(function*(){try{if(!t.match(/samehadaku\.\w+\/anime/gi))return o("Invalid URL");const s=yield i.get(t);if("OK"!==s.statusText)return o("Fail Fetching");const n=e.load(s.data),a={title:n('.infoanime > h1[itemprop="name"]').text().trim().replace("Nonton Anime ",""),thumbnail:n(".infoanime > .thumb > img").attr("src")||"",published:new Date(n(".anim-senct").find("time").attr("datetime")||""),trailer:n(".trailer-anime").find("iframe").attr("src")||"",rating:n(".infoanime").find('span[itemprop="ratingValue"]').text().trim()+"/"+n(".infoanime").find('i.hidden[itemprop="ratingCount"]').attr("content"),description:n(".infox > .desc").text().trim(),genre:n(".infox > .genre-info > a").map(((e,t)=>n(t).text().trim())).get(),detail:n("h3.anim-detail").next().find("span").map(((e,t)=>({name:n(t).find("b").text().trim(),data:`${n(t).text().trim()}`.replace(n(t).find("b").text().trim()+" ","").trim()}))).get(),batch:n(".listbatch").find("a").attr("href")||null,episode:n(".lstepsiode > ul > li").map(((e,t)=>({title:n(t).find(".lchx > a").text().trim(),date:n(t).find(".date").text().trim(),link:n(t).find(".eps > a").attr("href")||""}))).get()};r(a)}catch(e){o(e)}}))))}))}download(r){return p(this,void 0,void 0,(function*(){return new Promise(((o,s)=>p(this,void 0,void 0,(function*(){try{if(!/samehadaku\.\w+\/[\w-]+episode/gi.test(r))return s("Invalid URL!");const n=yield i.get(r,{headers:{"user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36"}});if("OK"!==n.statusText)return s("Error Fetching");const a=e.load(n.data),d={title:a('h1[itemprop="name"]').text().trim(),link:r,downloads:[]};return d.downloads=yield Promise.all(a("div#server > ul > li").map(((r,o)=>p(this,void 0,void 0,(function*(){const r={name:a(o).find("span").text().trim(),post:a(o).find("div").attr("data-post")||"",nume:a(o).find("div").attr("data-nume")||"",type:a(o).find("div").attr("data-type")||"",link:""},s=new t;return s.append("action","player_ajax"),s.append("post",r.post),s.append("nume",r.nume),s.append("type",r.type),r.link=(yield i.post("https://samehadaku.email/wp-admin/admin-ajax.php",s,{headers:{"user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36",origin:"https://samehadaku.email"}}).then((e=>e.data)).then((t=>e.load(t)("iframe").attr("src"))))||"",r}))))),o(d)}catch(e){s(e)}}))))}))}}});
/**
 * Scraped By Kaviaann
 * Protected By MIT LICENSE
 * Whoever caught removing wm will be sued
 * @description Any Request? Contact me : vielynian@gmail.com
 * @author Kaviaann 2024
 * @copyright https://whatsapp.com/channel/0029Vac0YNgAjPXNKPXCvE2e
 */var g=Object.freeze({__proto__:null,Mlbb:
/**
 * Scraped By Kaviaann
 * Protected By MIT LICENSE
 * Whoever caught removing wm will be sued
 * @description Any Request? Contact me : vielynian@gmail.com
 * @author Kaviaann 2024
 * @copyright https://whatsapp.com/channel/0029Vac0YNgAjPXNKPXCvE2e
 */
class{constructor(){}latestHero(){return p(this,void 0,void 0,(function*(){return new Promise(((e,t)=>p(this,void 0,void 0,(function*(){try{const r={Accept:"application/json, text/plain, */*",Authorization:"ihm6nDSwFbknXGFFP+4nXrplZ5Y=",origin:"https://m.mobilelegends.com",referer:"https://m.mobilelegends.com/","User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36","x-actid":2669607,"x-appid":2669606,"x-lang":"en"},o={filters:[],object:[],pageIndex:1,pageSize:6,sorts:[{data:{field:"hero_id",order:"desc"},type:"sequence"}]},s=yield i.post("https://api.gms.moontontech.com/api/gms/source/2669606/2756564",o,{headers:r}).then((e=>e.data)).then((e=>e.data.records.map((e=>e.data)))).catch((e=>null));if(!s)return t(Error("Fail to get latest hero"));e({total:s.length,data:s.map((e=>{const t=e.hero.data,i={name:t.name,id:t.heroid,media:{icon:t.head,png:t.painting,potrait:t.smallmap,head:t.squarehead,header:t.squareheadbig},createdAt:e.hero._createdAt,updatedAt:e.hero._updatedAt,story:t.story,tale:t.tale||"",sourceId:e.hero.sourceId,link:e.url,lane:t.roadsort.filter((e=>e)).map((e=>({name:e.data.road_sort_title,id:e.data.road_sort_id,icon:e.data.road_sort_icon}))),role:t.sortid.filter((e=>e)).map((e=>({name:e.data.sort_title,id:e.data.sort_id,icon:e.data.sort_icon}))),ability:{durability:t.abilityshow[0],offense:t.abilityshow[1],ability_effects:t.abilityshow[2],difficulty:t.abilityshow[3]},skill:t.heroskilllist.filter((e=>e)).map((e=>e.skilllist.map((e=>{const t={name:e.skillname,id:e.skillid,icon:e.skillicon,desc:e.skilldesc.replace(/<\/?[^>]+(>|$)/g,""),update:e.skilltag,video:e.skillvideo,cd:""};return e["skillcd&cost"].split("   ").forEach((e=>{const i=e.split(": "),r=i[0].trim().toLowerCase().replace(/ /gi,"_");t[r]=i[1]})),t})))),speciality:t.speciality,difficulty:t.difficulty,relation:e.relation,level:t.recommendlevel};return i}))})}catch(e){return t(e)}}))))}))}}
/**
 * Scraped By Kaviaann
 * Protected By MIT LICENSE
 * Whoever caught removing wm will be sued
 * @description Any Request? Contact me : vielynian@gmail.com
 * @author Kaviaann 2024
 * @copyright https://whatsapp.com/channel/0029Vac0YNgAjPXNKPXCvE2e
 */,Saweria:class{constructor(){this.BASE_URL="https://saweria.co",this.BACKEND="https://backend.saweria.co",this.token="",this.saweria=""}login(e,t){return p(this,void 0,void 0,(function*(){return new Promise(((r,o)=>p(this,void 0,void 0,(function*(){try{const o=yield i.post(this.BACKEND+"/auth/login",{email:e,password:t});this.setToken(o.headers.authorization),this.setSaweria(o.data.data.username),r(Object.assign({authorization:o.headers.authorization},o.data))}catch(e){o("Incorrect Email Or Password")}}))))}))}register(e){return p(this,void 0,void 0,(function*(){return new Promise(((t,r)=>p(this,void 0,void 0,(function*(){try{const r=yield i.post(this.BACKEND+"/auth/register",{email:e,currency:"IDR"},{headers:{origin:this.BASE_URL}});t({success:!0,data:"Check Email On "+r.data.data.email,email:r.data.data.email})}catch(t){r({success:!1,data:"Email Is Taken",email:e})}}))))}))}getUser(){return p(this,void 0,void 0,(function*(){return new Promise(((e,t)=>p(this,void 0,void 0,(function*(){try{if(!this.token)return t("Please login first or setup token manually");const r=yield i.get(this.BACKEND+"/users",{headers:{Authorization:this.token,origin:this.BASE_URL}});e(r.data.data)}catch(e){t(e)}}))))}))}getSaweria(t){return p(this,void 0,void 0,(function*(){return new Promise(((r,o)=>p(this,void 0,void 0,(function*(){try{if(!/saweria\.co\/\w+/gi.test(t))return o("Invalid URL");const s=yield i.get(t).then((e=>e.data)).then((t=>e.load(t)("script#__NEXT_DATA__").text().trim())).then((e=>JSON.parse(e))).then((e=>e.props.pageProps.data));r(s)}catch(e){o(e)}}))))}))}setToken(e){return p(this,void 0,void 0,(function*(){this.token=e}))}setSaweria(e){return p(this,void 0,void 0,(function*(){this.saweria="https://saweria.co/"+e}))}createPayment(){return p(this,arguments,void 0,(function*(e=1e3,t="hi",r=this.token){return new Promise(((r,o)=>p(this,void 0,void 0,(function*(){try{if(!this.token)return o("Login Required");if(e<1e3)return o("Invalid Amount Of Money, Enter More Or Equal To 1000 RP");const s=yield this.getUser(),n=yield i.post(this.BACKEND+"/donations/"+s.id,{agree:!0,amount:e,currency:"IDR",customer_info:{first_name:s.username,email:s.email,phone:""},message:t,notUnderage:!0,payment_type:"qris",vote:""},{headers:{origin:this.BASE_URL,Authorization:this.token,"Content-Type":"application/json"}});r(Object.assign({link:this.BASE_URL+"/qris/"+n.data.data.id},n.data))}catch(e){o(e)}}))))}))}sendPayment(e){return p(this,arguments,void 0,(function*(e,t=1e3,i="hi"){return new Promise(((r,o)=>p(this,void 0,void 0,(function*(){try{const o=yield this.getSaweria(e);r(yield this.createPayment(t,i,o.id))}catch(e){o(e)}}))))}))}status(e){return p(this,void 0,void 0,(function*(){return new Promise(((t,r)=>p(this,void 0,void 0,(function*(){try{const r=yield i.get(this.BACKEND+"/donations/qris/"+e).then((e=>e.data));t(Object.assign({id:e,done:""===r.data.qr_string},r))}catch(e){r(e)}}))))}))}getBalance(){return p(this,void 0,void 0,(function*(){return new Promise(((e,t)=>p(this,void 0,void 0,(function*(){try{if(!this.token)return t("Login to your saweria account first");const{data:r}=yield i.get(this.BACKEND+"/donations/balance",{headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36",Authorization:this.token,origin:this.BASE_URL}});e(r.data)}catch(e){t(e)}}))))}))}getTransaction(){return p(this,arguments,void 0,(function*(e=1){return new Promise(((t,r)=>p(this,void 0,void 0,(function*(){try{if(!this.token)return r("Login to your saweria account first");const{data:o}=yield i.get(this.BACKEND+"/transactions?page="+e+"&page_size=15",{headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36",Authorization:this.token,origin:this.BASE_URL}});t({total:o.data.transactions.length,data:o.data.transactions.map((e=>(delete e.amount_raw,delete e.etc,delete e.failure_code,Object.assign({},e))))})}catch(e){r(e)}}))))}))}}
/**
 * Scraped By Kaviaann
 * Protected By MIT LICENSE
 * Whoever caught removing wm will be sued
 * @description Any Request? Contact me : vielynian@gmail.com
 * @author Kaviaann 2024
 * @copyright https://whatsapp.com/channel/0029Vac0YNgAjPXNKPXCvE2e
 */,ffStalk:function(e){return p(this,void 0,void 0,(function*(){return new Promise(((t,o)=>p(this,void 0,void 0,(function*(){try{const s={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36","X-Device":r()},n=yield i.post("https://api.duniagames.co.id/api/item-catalog/v1/get-token",{msisdn:"0812665588"},{headers:s}).then((e=>e.data)).then((e=>e.status.code?o(Error("Fail initializing token")):e.data.token)),a=yield i.post("https://api.duniagames.co.id/api/transaction/v1/top-up/inquiry/store",{productId:3,itemId:353,product_ref:"REG",product_ref_denom:"REG",catalogId:376,paymentId:1252,gameId:e,token:n,campaignUrl:""},{headers:s}).then((e=>e.data)).then((e=>e.data.gameDetail.userName));return t({id:e,name:a})}catch(e){return o(e)}}))))}))},postid:function(e){return p(this,void 0,void 0,(function*(){return new Promise(((t,r)=>p(this,void 0,void 0,(function*(){var o;try{const r=yield i.get("https://kodeposku.com/cari?"+new URLSearchParams({q:String(e),_rsc:"1mart"}),{headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.0.0 Safari/537.36",rsc:1,"next-url":"/cari","next-router-state-tree":"%5B%22%22%2C%7B%22children%22%3A%5B%22(application)%22%2C%7B%22children%22%3A%5B%22cari%22%2C%7B%22children%22%3A%5B%22__PAGE__%3F%7B%5C%22q%5C%22%3A%5C%227371%5C%22%7D%22%2C%7B%7D%5D%7D%5D%7D%5D%7D%2Cnull%2Cnull%2Ctrue%5D"}}).then((e=>e.data)).catch((e=>e.response.data));return t(JSON.parse((null===(o=/{"villages":(\[(?:{"id":.*?,"kode_kemendagri":".*?","kode_pos":.*?,"kelurahan":".*?","kecamatan":".*?","kota":".*?","provinsi":".*?","zona_waktu":".*?","lintang":.*?,"bujur":.*?,"elevasi":.*?},?)\])/g.exec(r))||void 0===o?void 0:o[1])||"[]"))}catch(e){return r(e)}}))))}))}});
/**
 * Scraped By Kaviaann
 * Protected By MIT LICENSE
 * Whoever caught removing wm will be sued
 * @description Any Request? Contact me : vielynian@gmail.com
 * @author Kaviaann 2024
 * @copyright https://whatsapp.com/channel/0029Vac0YNgAjPXNKPXCvE2e
 */var b=Object.freeze({__proto__:null,drive:
/**
 * Scraped By Kaviaann
 * Protected By MIT LICENSE
 * Whoever caught removing wm will be sued
 * @description Any Request? Contact me : vielynian@gmail.com
 * @author Kaviaann 2024
 * @copyright https://whatsapp.com/channel/0029Vac0YNgAjPXNKPXCvE2e
 */
function(t){return p(this,void 0,void 0,(function*(){return new Promise(((r,o)=>p(this,void 0,void 0,(function*(){var s,n;try{if(!t.match(/drive\.google\.com\/file/i))return o("Invalid URL!");const a=yield i.get(t,{headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36"}}).then((e=>e.data)),d=e.load(a),h={name:d("head").find('meta[property="og:title"]').attr("content")||"",link:(null===(s=d("head").find('meta[property="og:url"]').attr("content"))||void 0===s?void 0:s.split("?")[0])||t,download:"https://drive.usercontent.google.com/u/0/uc?"+new URLSearchParams({id:(null===(n=t.match(/file\/d\/([\w\d-]+)/i))||void 0===n?void 0:n[1])||""})};r(h)}catch(e){o(e)}}))))}))}
/**
 * Scraped By Kaviaann
 * Protected By MIT LICENSE
 * Whoever caught removing wm will be sued
 * @description Any Request? Contact me : vielynian@gmail.com
 * @author Kaviaann 2024
 * @copyright https://whatsapp.com/channel/0029Vac0YNgAjPXNKPXCvE2e
 */,facebook:
/**
 * Scraped By Kaviaann
 * Protected By MIT LICENSE
 * Whoever caught removing wm will be sued
 * @description Any Request? Contact me : vielynian@gmail.com
 * @author Kaviaann 2024
 * @copyright https://whatsapp.com/channel/0029Vac0YNgAjPXNKPXCvE2e
 */
function(t){return p(this,void 0,void 0,(function*(){return new Promise(((r,o)=>p(this,void 0,void 0,(function*(){var s,n;try{if(!t.match(/facebook\.\w+\/(reel|watch|share)/gi))return o("Invalid URL, Enter A Valid Facebook Video URL");const a=yield i.get("https://fdownloader.net/id",{headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36"}}).then((e=>e.data)),d=/k_exp ?= ?"(\d+)"/i,h=/k_token ?= ?"([a-f0-9]+)"/i,l=null===(s=a.match(d))||void 0===s?void 0:s[1],c=null===(n=a.match(h))||void 0===n?void 0:n[1];if(!l||!c)return o("Error Extracting Exp And Token");const u=yield i.post("https://v3.fdownloader.net/api/ajaxSearch?lang=id",new URLSearchParams({k_exp:l,k_token:c,q:t,lang:"id",web:"fdownloader.net",v:"v2",w:""}),{headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36",origin:"https://fdownloader.net"}}).then((e=>e.data));if("ok"!==u.status)return o("Failed Doing Ajax Search");const f=e.load(u.data),m=e.load(f(".detail").html()||""),p={title:m(".thumbnail > .content > .clearfix > h3").text().trim(),duration:m(".thumbnail > .content > .clearfix > p").text().trim(),thumbnail:m(".thumbnail > .image-fb > img").attr("src")||"",media:m("#popup_play > .popup-body > .popup-content > #vid").attr("src")||"",video:m("#fbdownloader").find(".tab__content").eq(0).find("tr").map(((e,t)=>{const i={quality:m(t).find(".video-quality").text().trim(),url:m(t).find("a").attr("href")||m(t).find("button").attr("data-videourl")||t};if("#note_convert"!==i.url)return i})).get(),music:m("#fbdownloader").find("#audioUrl").attr("value")||""};r(p)}catch(e){o(e)}}))))}))},spotify:function(r){return p(this,void 0,void 0,(function*(){return new Promise(((o,s)=>p(this,void 0,void 0,(function*(){try{const n=e.load((yield i.get("https://spotifymate.com/en",{headers:{cookie:"session_data=o8079end5j9oslm5a7bou84rqc;","User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36"}})).data),a={name:n("form#get_video").find('input[type="hidden"]').attr("name")||"",value:n("form#get_video").find('input[type="hidden"]').attr("value")||""},d=new t;d.append("url",r),d.append(a.name,a.value);let h=yield i.post("https://spotifymate.com/action",d,{headers:Object.assign(Object.assign({origin:"https://spotifymate.com/en"},d.getHeaders()),{cookie:"session_data=o8079end5j9oslm5a7bou84rqc;","User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36"})});if("OK"!==h.statusText)return s("Fail Fetching");const l=e.load(h.data),c={title:l(".dlvideos").find('h3[itemprop="name"]').text().trim(),author:l(".dlvideos").find(".spotifymate-downloader-middle > p > span").text().trim(),thumbnail:l(".dlvideos").find("img").attr("src")||"",cover:l(".dlvideos").find(".spotifymate-downloader-right").find("#none").eq(1).find("a").attr("href")||l(".dlvideos").find(".spotifymate-downloader-right").find("#pop").eq(1).find("a").attr("href")||"",music:l(".dlvideos").find(".spotifymate-downloader-right").find("#none").eq(0).find("a").attr("href")||l(".dlvideos").find(".spotifymate-downloader-right").find("#pop").eq(0).find("a").attr("href")||"",link:r};o(c)}catch(e){s(e)}}))))}))},youtube:function(e){return p(this,void 0,void 0,(function*(){return new Promise(((t,r)=>p(this,void 0,void 0,(function*(){var s;try{!(e=e.trim())&&r("Enter either a youtube link for downloading, or query for searching");if(/youtu(\.)?be/gi.test(e)){const n=(null===(s=/(?:youtu\.be\/|youtube\.com(?:\/(?:[^\/\n\s]+\/\S+\/|(?:v|e(?:mbed)?)\/|\S*?[?&]v=|shorts\/)|youtu\.be\/|embed\/|v\/|m\/|watch\?(?:[^=]+=[^&]+&)*?v=))([^"&?\/\s]{11})/gm.exec(e))||void 0===s?void 0:s[1])||"";if(!n)return r("Enter valid youtube video link!");const{title:a,description:d,url:h,videoId:l,seconds:c,timestamp:u,views:f,genre:m,uploadDate:_,ago:v,image:y,thumbnail:g,author:b}=yield o({videoId:n}),w={Accept:"*/*",Origin:"https://id-y2mate.com",Referer:"https://id-y2mate.com/","User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.0.0 Safari/537.36","Sec-Ch-Ua-Platform-Version":'"15.0.0"',"Sec-Ch-Ua-Bitness":"64","Sec-Ch-Ua-Model":"","Sec-Ch-Ua-Mobile":"?0","Sec-Ch-Ua-Arch":"x86","X-Requested-With":"XMLHttpRequest","Sec-Ch-Ua-Full-Version":"129.0.6668.90","Sec-Ch-Ua-Full-Version-List":'"Google Chrome";v="129.0.6668.90", "Not=A?Brand";v="8.0.0.0", "Chromium";v="129.0.6668.90"'},k=yield i.post("https://id-y2mate.com/mates/analyzeV2/ajax",new URLSearchParams({k_query:`https://youtube.com/watch?v=${n}`,k_page:"home",hl:"",q_auto:"0"}),{headers:w}).then((e=>e.data));if(!k)return r(new Error("Fail to get video & audio"));const S={mp3:{},mp4:{}};return yield new Promise((e=>{for(let e of Object.values(k.links.mp4))Object.assign(S.mp4,{[e.q]:()=>p(this,void 0,void 0,(function*(){return new Promise(((t,r)=>p(this,void 0,void 0,(function*(){try{const o=yield i.post("https://id-y2mate.com/mates/convertV2/index",new URLSearchParams({vid:n,k:e.k}),{headers:Object.assign(Object.assign({},w),{Referer:w.Referer+n})}).then((e=>e.data));return o&&"ok"===o.status?t({size:e.size,format:e.f,url:o.dlink}):r(new Error("Fail to convert video"))}catch(e){return r(e)}}))))}))});for(let e of Object.values(k.links.mp3))Object.assign(S.mp3,{[e.f]:()=>p(this,void 0,void 0,(function*(){return new Promise(((t,r)=>p(this,void 0,void 0,(function*(){try{const o=yield i.post("https://id-y2mate.com/mates/convertV2/index",new URLSearchParams({vid:n,k:e.k}),{headers:Object.assign(Object.assign({},w),{Referer:w.Referer+n})}).then((e=>e.data));return o&&"ok"===o.status?t({size:e.size,format:e.f,url:o.dlink}):r(new Error("Fail to convert video"))}catch(e){return r(e)}}))))}))});e()})),t({type:"download",download:{title:a,description:d,url:h,id:l,duration:{seconds:c,timestamp:u},views:f,genre:m,releaseDate:_,published:v,media:{thumbnail:g,image:y},author:b,dl:yield S}})}{const i=yield o(e).then((e=>e.videos));return t({type:"search",query:e,total:i.length||0,videos:i.map((({videoId:e,views:t,url:i,title:r,description:o,image:s,thumbnail:n,seconds:a,timestamp:d,ago:h,author:l})=>({title:r,id:e,url:i,media:{thumbnail:n||"",image:s},description:o,duration:{seconds:a,timestamp:d},published:h,views:t,author:l})))})}}catch(e){return r(e)}}))))}))}});
/**
 * Scraped By Kaviaann
 * Protected By MIT LICENSE
 * Whoever caught removing wm will be sued
 * @description Any Request? Contact me : vielynian@gmail.com
 * @author Kaviaann 2024
 * @copyright https://whatsapp.com/channel/0029Vac0YNgAjPXNKPXCvE2e
 */function w(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var k={exports:{}};const S=["nodebuffer","arraybuffer","fragments"],E="undefined"!=typeof Blob;E&&S.push("blob");var x={BINARY_TYPES:S,EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",hasBlob:E,kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}};const{EMPTY_BUFFER:O}=x,T=Buffer[Symbol.species];function L(e,t,i,r,o){for(let s=0;s<o;s++)i[r+s]=e[s]^t[3&s]}function C(e,t){for(let i=0;i<e.length;i++)e[i]^=t[3&i]}if(k.exports={concat:function(e,t){if(0===e.length)return O;if(1===e.length)return e[0];const i=Buffer.allocUnsafe(t);let r=0;for(let t=0;t<e.length;t++){const o=e[t];i.set(o,r),r+=o.length}return r<t?new T(i.buffer,i.byteOffset,r):i},mask:L,toArrayBuffer:function(e){return e.length===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.length)},toBuffer:function e(t){if(e.readOnly=!0,Buffer.isBuffer(t))return t;let i;return t instanceof ArrayBuffer?i=new T(t):ArrayBuffer.isView(t)?i=new T(t.buffer,t.byteOffset,t.byteLength):(i=Buffer.from(t),e.readOnly=!1),i},unmask:C},!process.env.WS_NO_BUFFER_UTIL)try{const e=require("bufferutil");k.exports.mask=function(t,i,r,o,s){s<48?L(t,i,r,o,s):e.mask(t,i,r,o,s)},k.exports.unmask=function(t,i){t.length<32?C(t,i):e.unmask(t,i)}}catch(e){}var N=k.exports;const P=Symbol("kDone"),B=Symbol("kRun");const R=n,A=N,U=class{constructor(e){this[P]=()=>{this.pending--,this[B]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[B]()}[B](){if(this.pending!==this.concurrency&&this.jobs.length){const e=this.jobs.shift();this.pending++,e(this[P])}}},{kStatusCode:I}=x,W=Buffer[Symbol.species],M=Buffer.from([0,0,255,255]),D=Symbol("permessage-deflate"),F=Symbol("total-length"),j=Symbol("callback"),q=Symbol("buffers"),G=Symbol("error");let z;var K=class{constructor(e,t,i){if(this._maxPayload=0|i,this._options=e||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,!z){const e=void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10;z=new U(e)}}static get extensionName(){return"permessage-deflate"}offer(){const e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){const e=this._deflate[j];this._deflate.close(),this._deflate=null,e&&e(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){const t=this._options,i=e.find((e=>!(!1===t.serverNoContextTakeover&&e.server_no_context_takeover||e.server_max_window_bits&&(!1===t.serverMaxWindowBits||"number"==typeof t.serverMaxWindowBits&&t.serverMaxWindowBits>e.server_max_window_bits)||"number"==typeof t.clientMaxWindowBits&&!e.client_max_window_bits)));if(!i)throw new Error("None of the extension offers can be accepted");return t.serverNoContextTakeover&&(i.server_no_context_takeover=!0),t.clientNoContextTakeover&&(i.client_no_context_takeover=!0),"number"==typeof t.serverMaxWindowBits&&(i.server_max_window_bits=t.serverMaxWindowBits),"number"==typeof t.clientMaxWindowBits?i.client_max_window_bits=t.clientMaxWindowBits:!0!==i.client_max_window_bits&&!1!==t.clientMaxWindowBits||delete i.client_max_window_bits,i}acceptAsClient(e){const t=e[0];if(!1===this._options.clientNoContextTakeover&&t.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(t.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(t.client_max_window_bits=this._options.clientMaxWindowBits);return t}normalizeParams(e){return e.forEach((e=>{Object.keys(e).forEach((t=>{let i=e[t];if(i.length>1)throw new Error(`Parameter "${t}" must have only a single value`);if(i=i[0],"client_max_window_bits"===t){if(!0!==i){const e=+i;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${i}`);i=e}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${t}": ${i}`)}else if("server_max_window_bits"===t){const e=+i;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${i}`);i=e}else{if("client_no_context_takeover"!==t&&"server_no_context_takeover"!==t)throw new Error(`Unknown parameter "${t}"`);if(!0!==i)throw new TypeError(`Invalid value for parameter "${t}": ${i}`)}e[t]=i}))})),e}decompress(e,t,i){z.add((r=>{this._decompress(e,t,((e,t)=>{r(),i(e,t)}))}))}compress(e,t,i){z.add((r=>{this._compress(e,t,((e,t)=>{r(),i(e,t)}))}))}_decompress(e,t,i){const r=this._isServer?"client":"server";if(!this._inflate){const e=`${r}_max_window_bits`,t="number"!=typeof this.params[e]?R.Z_DEFAULT_WINDOWBITS:this.params[e];this._inflate=R.createInflateRaw({...this._options.zlibInflateOptions,windowBits:t}),this._inflate[D]=this,this._inflate[F]=0,this._inflate[q]=[],this._inflate.on("error",H),this._inflate.on("data",$)}this._inflate[j]=i,this._inflate.write(e),t&&this._inflate.write(M),this._inflate.flush((()=>{const e=this._inflate[G];if(e)return this._inflate.close(),this._inflate=null,void i(e);const o=A.concat(this._inflate[q],this._inflate[F]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[F]=0,this._inflate[q]=[],t&&this.params[`${r}_no_context_takeover`]&&this._inflate.reset()),i(null,o)}))}_compress(e,t,i){const r=this._isServer?"server":"client";if(!this._deflate){const e=`${r}_max_window_bits`,t="number"!=typeof this.params[e]?R.Z_DEFAULT_WINDOWBITS:this.params[e];this._deflate=R.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:t}),this._deflate[F]=0,this._deflate[q]=[],this._deflate.on("data",V)}this._deflate[j]=i,this._deflate.write(e),this._deflate.flush(R.Z_SYNC_FLUSH,(()=>{if(!this._deflate)return;let e=A.concat(this._deflate[q],this._deflate[F]);t&&(e=new W(e.buffer,e.byteOffset,e.length-4)),this._deflate[j]=null,this._deflate[F]=0,this._deflate[q]=[],t&&this.params[`${r}_no_context_takeover`]&&this._deflate.reset(),i(null,e)}))}};function V(e){this[q].push(e),this[F]+=e.length}function $(e){this[F]+=e.length,this[D]._maxPayload<1||this[F]<=this[D]._maxPayload?this[q].push(e):(this[G]=new RangeError("Max payload size exceeded"),this[G].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[G][I]=1009,this.removeListener("data",$),this.reset())}function H(e){this[D]._inflate=null,e[I]=1007,this[j](e)}var Y={exports:{}};const{isUtf8:X}=a,{hasBlob:J}=x;function Z(e){const t=e.length;let i=0;for(;i<t;)if(128&e[i])if(192==(224&e[i])){if(i+1===t||128!=(192&e[i+1])||192==(254&e[i]))return!1;i+=2}else if(224==(240&e[i])){if(i+2>=t||128!=(192&e[i+1])||128!=(192&e[i+2])||224===e[i]&&128==(224&e[i+1])||237===e[i]&&160==(224&e[i+1]))return!1;i+=3}else{if(240!=(248&e[i]))return!1;if(i+3>=t||128!=(192&e[i+1])||128!=(192&e[i+2])||128!=(192&e[i+3])||240===e[i]&&128==(240&e[i+1])||244===e[i]&&e[i+1]>143||e[i]>244)return!1;i+=4}else i++;return!0}if(Y.exports={isBlob:function(e){return J&&"object"==typeof e&&"function"==typeof e.arrayBuffer&&"string"==typeof e.type&&"function"==typeof e.stream&&("Blob"===e[Symbol.toStringTag]||"File"===e[Symbol.toStringTag])},isValidStatusCode:function(e){return e>=1e3&&e<=1014&&1004!==e&&1005!==e&&1006!==e||e>=3e3&&e<=4999},isValidUTF8:Z,tokenChars:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0]},X)Y.exports.isValidUTF8=function(e){return e.length<24?Z(e):X(e)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{const e=require("utf-8-validate");Y.exports.isValidUTF8=function(t){return t.length<32?Z(t):e(t)}}catch(e){}var Q=Y.exports;const{Writable:ee}=s,te=K,{BINARY_TYPES:ie,EMPTY_BUFFER:re,kStatusCode:oe,kWebSocket:se}=x,{concat:ne,toArrayBuffer:ae,unmask:de}=N,{isValidStatusCode:he,isValidUTF8:le}=Q,ce=Buffer[Symbol.species];var ue=class extends ee{constructor(e={}){super(),this._allowSynchronousEvents=void 0===e.allowSynchronousEvents||e.allowSynchronousEvents,this._binaryType=e.binaryType||ie[0],this._extensions=e.extensions||{},this._isServer=!!e.isServer,this._maxPayload=0|e.maxPayload,this._skipUTF8Validation=!!e.skipUTF8Validation,this[se]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._errored=!1,this._loop=!1,this._state=0}_write(e,t,i){if(8===this._opcode&&0==this._state)return i();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(i)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){const t=this._buffers[0];return this._buffers[0]=new ce(t.buffer,t.byteOffset+e,t.length-e),new ce(t.buffer,t.byteOffset,e)}const t=Buffer.allocUnsafe(e);do{const i=this._buffers[0],r=t.length-e;e>=i.length?t.set(this._buffers.shift(),r):(t.set(new Uint8Array(i.buffer,i.byteOffset,e),r),this._buffers[0]=new ce(i.buffer,i.byteOffset+e,i.length-e)),e-=i.length}while(e>0);return t}startLoop(e){this._loop=!0;do{switch(this._state){case 0:this.getInfo(e);break;case 1:this.getPayloadLength16(e);break;case 2:this.getPayloadLength64(e);break;case 3:this.getMask();break;case 4:this.getData(e);break;case 5:case 6:return void(this._loop=!1)}}while(this._loop);this._errored||e()}getInfo(e){if(this._bufferedBytes<2)return void(this._loop=!1);const t=this.consume(2);if(48&t[0]){return void e(this.createError(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3"))}const i=!(64&~t[0]);if(!i||this._extensions[te.extensionName]){if(this._fin=!(128&~t[0]),this._opcode=15&t[0],this._payloadLength=127&t[1],0===this._opcode){if(i){return void e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"))}if(!this._fragmented){return void e(this.createError(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE"))}this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented){return void e(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"))}this._compressed=i}else{if(!(this._opcode>7&&this._opcode<11)){return void e(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"))}if(!this._fin){return void e(this.createError(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN"))}if(i){return void e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"))}if(this._payloadLength>125||8===this._opcode&&1===this._payloadLength){return void e(this.createError(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH"))}}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=!(128&~t[1]),this._isServer){if(!this._masked){return void e(this.createError(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK"))}}else if(this._masked){return void e(this.createError(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK"))}126===this._payloadLength?this._state=1:127===this._payloadLength?this._state=2:this.haveLength(e)}else{e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"))}}getPayloadLength16(e){this._bufferedBytes<2?this._loop=!1:(this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength(e))}getPayloadLength64(e){if(this._bufferedBytes<8)return void(this._loop=!1);const t=this.consume(8),i=t.readUInt32BE(0);if(i>Math.pow(2,21)-1){e(this.createError(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH"))}else this._payloadLength=i*Math.pow(2,32)+t.readUInt32BE(4),this.haveLength(e)}haveLength(e){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0)){e(this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"))}else this._masked?this._state=3:this._state=4}getMask(){this._bufferedBytes<4?this._loop=!1:(this._mask=this.consume(4),this._state=4)}getData(e){let t=re;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength)return void(this._loop=!1);t=this.consume(this._payloadLength),this._masked&&this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3]&&de(t,this._mask)}if(this._opcode>7)this.controlMessage(t,e);else{if(this._compressed)return this._state=5,void this.decompress(t,e);t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),this.dataMessage(e)}}decompress(e,t){this._extensions[te.extensionName].decompress(e,this._fin,((e,i)=>{if(e)return t(e);if(i.length){if(this._messageLength+=i.length,this._messageLength>this._maxPayload&&this._maxPayload>0){const e=this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");return void t(e)}this._fragments.push(i)}this.dataMessage(t),0===this._state&&this.startLoop(t)}))}dataMessage(e){if(!this._fin)return void(this._state=0);const t=this._messageLength,i=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){let r;r="nodebuffer"===this._binaryType?ne(i,t):"arraybuffer"===this._binaryType?ae(ne(i,t)):"blob"===this._binaryType?new Blob(i):i,this._allowSynchronousEvents?(this.emit("message",r,!0),this._state=0):(this._state=6,setImmediate((()=>{this.emit("message",r,!0),this._state=0,this.startLoop(e)})))}else{const r=ne(i,t);if(!this._skipUTF8Validation&&!le(r)){const t=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");return void e(t)}5===this._state||this._allowSynchronousEvents?(this.emit("message",r,!1),this._state=0):(this._state=6,setImmediate((()=>{this.emit("message",r,!1),this._state=0,this.startLoop(e)})))}}controlMessage(e,t){if(8!==this._opcode)this._allowSynchronousEvents?(this.emit(9===this._opcode?"ping":"pong",e),this._state=0):(this._state=6,setImmediate((()=>{this.emit(9===this._opcode?"ping":"pong",e),this._state=0,this.startLoop(t)})));else{if(0===e.length)this._loop=!1,this.emit("conclude",1005,re),this.end();else{const i=e.readUInt16BE(0);if(!he(i)){const e=this.createError(RangeError,`invalid status code ${i}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");return void t(e)}const r=new ce(e.buffer,e.byteOffset+2,e.length-2);if(!this._skipUTF8Validation&&!le(r)){const e=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");return void t(e)}this._loop=!1,this.emit("conclude",i,r),this.end()}this._state=0}}createError(e,t,i,r,o){this._loop=!1,this._errored=!0;const s=new e(i?`Invalid WebSocket frame: ${t}`:t);return Error.captureStackTrace(s,this.createError),s.code=o,s[oe]=r,s}};const{randomFillSync:fe}=d,me=K,{EMPTY_BUFFER:pe,kWebSocket:_e,NOOP:ve}=x,{isBlob:ye,isValidStatusCode:ge}=Q,{mask:be,toBuffer:we}=N,ke=Symbol("kByteLength"),Se=Buffer.alloc(4),Ee=8192;let xe,Oe=Ee;var Te=class e{constructor(e,t,i){this._extensions=t||{},i&&(this._generateMask=i,this._maskBuffer=Buffer.alloc(4)),this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._queue=[],this._state=0,this.onerror=ve,this[_e]=void 0}static frame(e,t){let i,r,o=!1,s=2,n=!1;t.mask&&(i=t.maskBuffer||Se,t.generateMask?t.generateMask(i):(Oe===Ee&&(void 0===xe&&(xe=Buffer.alloc(Ee)),fe(xe,0,Ee),Oe=0),i[0]=xe[Oe++],i[1]=xe[Oe++],i[2]=xe[Oe++],i[3]=xe[Oe++]),n=!(i[0]|i[1]|i[2]|i[3]),s=6),"string"==typeof e?r=t.mask&&!n||void 0===t[ke]?(e=Buffer.from(e)).length:t[ke]:(r=e.length,o=t.mask&&t.readOnly&&!n);let a=r;r>=65536?(s+=8,a=127):r>125&&(s+=2,a=126);const d=Buffer.allocUnsafe(o?r+s:s);return d[0]=t.fin?128|t.opcode:t.opcode,t.rsv1&&(d[0]|=64),d[1]=a,126===a?d.writeUInt16BE(r,2):127===a&&(d[2]=d[3]=0,d.writeUIntBE(r,4,6)),t.mask?(d[1]|=128,d[s-4]=i[0],d[s-3]=i[1],d[s-2]=i[2],d[s-1]=i[3],n?[d,e]:o?(be(e,i,d,s,r),[d]):(be(e,i,e,0,r),[d,e])):[d,e]}close(t,i,r,o){let s;if(void 0===t)s=pe;else{if("number"!=typeof t||!ge(t))throw new TypeError("First argument must be a valid error code number");if(void 0!==i&&i.length){const e=Buffer.byteLength(i);if(e>123)throw new RangeError("The message must not be greater than 123 bytes");s=Buffer.allocUnsafe(2+e),s.writeUInt16BE(t,0),"string"==typeof i?s.write(i,2):s.set(i,2)}else s=Buffer.allocUnsafe(2),s.writeUInt16BE(t,0)}const n={[ke]:s.length,fin:!0,generateMask:this._generateMask,mask:r,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};0!==this._state?this.enqueue([this.dispatch,s,!1,n,o]):this.sendFrame(e.frame(s,n),o)}ping(t,i,r){let o,s;if("string"==typeof t?(o=Buffer.byteLength(t),s=!1):ye(t)?(o=t.size,s=!1):(o=(t=we(t)).length,s=we.readOnly),o>125)throw new RangeError("The data size must not be greater than 125 bytes");const n={[ke]:o,fin:!0,generateMask:this._generateMask,mask:i,maskBuffer:this._maskBuffer,opcode:9,readOnly:s,rsv1:!1};ye(t)?0!==this._state?this.enqueue([this.getBlobData,t,!1,n,r]):this.getBlobData(t,!1,n,r):0!==this._state?this.enqueue([this.dispatch,t,!1,n,r]):this.sendFrame(e.frame(t,n),r)}pong(t,i,r){let o,s;if("string"==typeof t?(o=Buffer.byteLength(t),s=!1):ye(t)?(o=t.size,s=!1):(o=(t=we(t)).length,s=we.readOnly),o>125)throw new RangeError("The data size must not be greater than 125 bytes");const n={[ke]:o,fin:!0,generateMask:this._generateMask,mask:i,maskBuffer:this._maskBuffer,opcode:10,readOnly:s,rsv1:!1};ye(t)?0!==this._state?this.enqueue([this.getBlobData,t,!1,n,r]):this.getBlobData(t,!1,n,r):0!==this._state?this.enqueue([this.dispatch,t,!1,n,r]):this.sendFrame(e.frame(t,n),r)}send(e,t,i){const r=this._extensions[me.extensionName];let o,s,n=t.binary?2:1,a=t.compress;"string"==typeof e?(o=Buffer.byteLength(e),s=!1):ye(e)?(o=e.size,s=!1):(o=(e=we(e)).length,s=we.readOnly),this._firstFragment?(this._firstFragment=!1,a&&r&&r.params[r._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(a=o>=r._threshold),this._compress=a):(a=!1,n=0),t.fin&&(this._firstFragment=!0);const d={[ke]:o,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:n,readOnly:s,rsv1:a};ye(e)?0!==this._state?this.enqueue([this.getBlobData,e,this._compress,d,i]):this.getBlobData(e,this._compress,d,i):0!==this._state?this.enqueue([this.dispatch,e,this._compress,d,i]):this.dispatch(e,this._compress,d,i)}getBlobData(t,i,r,o){this._bufferedBytes+=r[ke],this._state=2,t.arrayBuffer().then((t=>{if(this._socket.destroyed){const e=new Error("The socket was closed while the blob was being read");return void process.nextTick(Le,this,e,o)}this._bufferedBytes-=r[ke];const s=we(t);i?this.dispatch(s,i,r,o):(this._state=0,this.sendFrame(e.frame(s,r),o),this.dequeue())})).catch((e=>{process.nextTick(Ce,this,e,o)}))}dispatch(t,i,r,o){if(!i)return void this.sendFrame(e.frame(t,r),o);const s=this._extensions[me.extensionName];this._bufferedBytes+=r[ke],this._state=1,s.compress(t,r.fin,((t,i)=>{if(this._socket.destroyed){Le(this,new Error("The socket was closed while data was being compressed"),o)}else this._bufferedBytes-=r[ke],this._state=0,r.readOnly=!1,this.sendFrame(e.frame(i,r),o),this.dequeue()}))}dequeue(){for(;0===this._state&&this._queue.length;){const e=this._queue.shift();this._bufferedBytes-=e[3][ke],Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[3][ke],this._queue.push(e)}sendFrame(e,t){2===e.length?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],t),this._socket.uncork()):this._socket.write(e[0],t)}};function Le(e,t,i){"function"==typeof i&&i(t);for(let i=0;i<e._queue.length;i++){const r=e._queue[i],o=r[r.length-1];"function"==typeof o&&o(t)}}function Ce(e,t,i){Le(e,t,i),e.onerror(t)}const{kForOnEventAttribute:Ne,kListener:Pe}=x,Be=Symbol("kCode"),Re=Symbol("kData"),Ae=Symbol("kError"),Ue=Symbol("kMessage"),Ie=Symbol("kReason"),We=Symbol("kTarget"),Me=Symbol("kType"),De=Symbol("kWasClean");class Fe{constructor(e){this[We]=null,this[Me]=e}get target(){return this[We]}get type(){return this[Me]}}Object.defineProperty(Fe.prototype,"target",{enumerable:!0}),Object.defineProperty(Fe.prototype,"type",{enumerable:!0});class je extends Fe{constructor(e,t={}){super(e),this[Be]=void 0===t.code?0:t.code,this[Ie]=void 0===t.reason?"":t.reason,this[De]=void 0!==t.wasClean&&t.wasClean}get code(){return this[Be]}get reason(){return this[Ie]}get wasClean(){return this[De]}}Object.defineProperty(je.prototype,"code",{enumerable:!0}),Object.defineProperty(je.prototype,"reason",{enumerable:!0}),Object.defineProperty(je.prototype,"wasClean",{enumerable:!0});class qe extends Fe{constructor(e,t={}){super(e),this[Ae]=void 0===t.error?null:t.error,this[Ue]=void 0===t.message?"":t.message}get error(){return this[Ae]}get message(){return this[Ue]}}Object.defineProperty(qe.prototype,"error",{enumerable:!0}),Object.defineProperty(qe.prototype,"message",{enumerable:!0});class Ge extends Fe{constructor(e,t={}){super(e),this[Re]=void 0===t.data?null:t.data}get data(){return this[Re]}}Object.defineProperty(Ge.prototype,"data",{enumerable:!0});const ze={addEventListener(e,t,i={}){for(const r of this.listeners(e))if(!i[Ne]&&r[Pe]===t&&!r[Ne])return;let r;if("message"===e)r=function(e,i){const r=new Ge("message",{data:i?e:e.toString()});r[We]=this,Ve(t,this,r)};else if("close"===e)r=function(e,i){const r=new je("close",{code:e,reason:i.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});r[We]=this,Ve(t,this,r)};else if("error"===e)r=function(e){const i=new qe("error",{error:e,message:e.message});i[We]=this,Ve(t,this,i)};else{if("open"!==e)return;r=function(){const e=new Fe("open");e[We]=this,Ve(t,this,e)}}r[Ne]=!!i[Ne],r[Pe]=t,i.once?this.once(e,r):this.on(e,r)},removeEventListener(e,t){for(const i of this.listeners(e))if(i[Pe]===t&&!i[Ne]){this.removeListener(e,i);break}}};var Ke={CloseEvent:je,ErrorEvent:qe,Event:Fe,EventTarget:ze,MessageEvent:Ge};function Ve(e,t,i){"object"==typeof e&&e.handleEvent?e.handleEvent.call(e,i):e.call(t,i)}const{tokenChars:$e}=Q;function He(e,t,i){void 0===e[t]?e[t]=[i]:e[t].push(i)}var Ye={format:function(e){return Object.keys(e).map((t=>{let i=e[t];return Array.isArray(i)||(i=[i]),i.map((e=>[t].concat(Object.keys(e).map((t=>{let i=e[t];return Array.isArray(i)||(i=[i]),i.map((e=>!0===e?t:`${t}=${e}`)).join("; ")}))).join("; "))).join(", ")})).join(", ")},parse:function(e){const t=Object.create(null);let i,r,o=Object.create(null),s=!1,n=!1,a=!1,d=-1,h=-1,l=-1,c=0;for(;c<e.length;c++)if(h=e.charCodeAt(c),void 0===i)if(-1===l&&1===$e[h])-1===d&&(d=c);else if(0===c||32!==h&&9!==h){if(59!==h&&44!==h)throw new SyntaxError(`Unexpected character at index ${c}`);{if(-1===d)throw new SyntaxError(`Unexpected character at index ${c}`);-1===l&&(l=c);const r=e.slice(d,l);44===h?(He(t,r,o),o=Object.create(null)):i=r,d=l=-1}}else-1===l&&-1!==d&&(l=c);else if(void 0===r)if(-1===l&&1===$e[h])-1===d&&(d=c);else if(32===h||9===h)-1===l&&-1!==d&&(l=c);else if(59===h||44===h){if(-1===d)throw new SyntaxError(`Unexpected character at index ${c}`);-1===l&&(l=c),He(o,e.slice(d,l),!0),44===h&&(He(t,i,o),o=Object.create(null),i=void 0),d=l=-1}else{if(61!==h||-1===d||-1!==l)throw new SyntaxError(`Unexpected character at index ${c}`);r=e.slice(d,c),d=l=-1}else if(n){if(1!==$e[h])throw new SyntaxError(`Unexpected character at index ${c}`);-1===d?d=c:s||(s=!0),n=!1}else if(a)if(1===$e[h])-1===d&&(d=c);else if(34===h&&-1!==d)a=!1,l=c;else{if(92!==h)throw new SyntaxError(`Unexpected character at index ${c}`);n=!0}else if(34===h&&61===e.charCodeAt(c-1))a=!0;else if(-1===l&&1===$e[h])-1===d&&(d=c);else if(-1===d||32!==h&&9!==h){if(59!==h&&44!==h)throw new SyntaxError(`Unexpected character at index ${c}`);{if(-1===d)throw new SyntaxError(`Unexpected character at index ${c}`);-1===l&&(l=c);let n=e.slice(d,l);s&&(n=n.replace(/\\/g,""),s=!1),He(o,r,n),44===h&&(He(t,i,o),o=Object.create(null),i=void 0),r=void 0,d=l=-1}}else-1===l&&(l=c);if(-1===d||a||32===h||9===h)throw new SyntaxError("Unexpected end of input");-1===l&&(l=c);const u=e.slice(d,l);return void 0===i?He(t,u,o):(void 0===r?He(o,u,!0):He(o,r,s?u.replace(/\\/g,""):u),He(t,i,o)),t}};const Xe=h,Je=l,Ze=c,Qe=u,et=f,{randomBytes:tt,createHash:it}=d,{URL:rt}=m,ot=K,st=ue,nt=Te,{isBlob:at}=Q,{BINARY_TYPES:dt,EMPTY_BUFFER:ht,GUID:lt,kForOnEventAttribute:ct,kListener:ut,kStatusCode:ft,kWebSocket:mt,NOOP:pt}=x,{EventTarget:{addEventListener:_t,removeEventListener:vt}}=Ke,{format:yt,parse:gt}=Ye,{toBuffer:bt}=N,wt=3e4,kt=Symbol("kAborted"),St=[8,13],Et=["CONNECTING","OPEN","CLOSING","CLOSED"],xt=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/;class Ot extends Xe{constructor(e,t,i){super(),this._binaryType=dt[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=ht,this._closeTimer=null,this._errorEmitted=!1,this._extensions={},this._paused=!1,this._protocol="",this._readyState=Ot.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,null!==e?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,void 0===t?t=[]:Array.isArray(t)||("object"==typeof t&&null!==t?(i=t,t=[]):t=[t]),Tt(this,e,t,i)):(this._autoPong=i.autoPong,this._isServer=!0)}get binaryType(){return this._binaryType}set binaryType(e){dt.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(e,t,i){const r=new st({allowSynchronousEvents:i.allowSynchronousEvents,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:i.maxPayload,skipUTF8Validation:i.skipUTF8Validation}),o=new nt(e,this._extensions,i.generateMask);this._receiver=r,this._sender=o,this._socket=e,r[mt]=this,o[mt]=this,e[mt]=this,r.on("conclude",Rt),r.on("drain",At),r.on("error",Ut),r.on("message",Wt),r.on("ping",Mt),r.on("pong",Dt),o.onerror=jt,e.setTimeout&&e.setTimeout(0),e.setNoDelay&&e.setNoDelay(),t.length>0&&e.unshift(t),e.on("close",Gt),e.on("data",zt),e.on("end",Kt),e.on("error",Vt),this._readyState=Ot.OPEN,this.emit("open")}emitClose(){if(!this._socket)return this._readyState=Ot.CLOSED,void this.emit("close",this._closeCode,this._closeMessage);this._extensions[ot.extensionName]&&this._extensions[ot.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=Ot.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,t){if(this.readyState!==Ot.CLOSED)if(this.readyState!==Ot.CONNECTING)this.readyState!==Ot.CLOSING?(this._readyState=Ot.CLOSING,this._sender.close(e,t,!this._isServer,(e=>{e||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())})),qt(this)):this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();else{const e="WebSocket was closed before the connection was established";Pt(this,this._req,e)}}pause(){this.readyState!==Ot.CONNECTING&&this.readyState!==Ot.CLOSED&&(this._paused=!0,this._socket.pause())}ping(e,t,i){if(this.readyState===Ot.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(i=e,e=t=void 0):"function"==typeof t&&(i=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===Ot.OPEN?(void 0===t&&(t=!this._isServer),this._sender.ping(e||ht,t,i)):Bt(this,e,i)}pong(e,t,i){if(this.readyState===Ot.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(i=e,e=t=void 0):"function"==typeof t&&(i=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===Ot.OPEN?(void 0===t&&(t=!this._isServer),this._sender.pong(e||ht,t,i)):Bt(this,e,i)}resume(){this.readyState!==Ot.CONNECTING&&this.readyState!==Ot.CLOSED&&(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(e,t,i){if(this.readyState===Ot.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof t&&(i=t,t={}),"number"==typeof e&&(e=e.toString()),this.readyState!==Ot.OPEN)return void Bt(this,e,i);const r={binary:"string"!=typeof e,mask:!this._isServer,compress:!0,fin:!0,...t};this._extensions[ot.extensionName]||(r.compress=!1),this._sender.send(e||ht,r,i)}terminate(){if(this.readyState!==Ot.CLOSED)if(this.readyState!==Ot.CONNECTING)this._socket&&(this._readyState=Ot.CLOSING,this._socket.destroy());else{const e="WebSocket was closed before the connection was established";Pt(this,this._req,e)}}}function Tt(e,t,i,r){const o={allowSynchronousEvents:!0,autoPong:!0,protocolVersion:St[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...r,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(e._autoPong=o.autoPong,!St.includes(o.protocolVersion))throw new RangeError(`Unsupported protocol version: ${o.protocolVersion} (supported versions: ${St.join(", ")})`);let s;if(t instanceof rt)s=t;else try{s=new rt(t)}catch(e){throw new SyntaxError(`Invalid URL: ${t}`)}"http:"===s.protocol?s.protocol="ws:":"https:"===s.protocol&&(s.protocol="wss:"),e._url=s.href;const n="wss:"===s.protocol,a="ws+unix:"===s.protocol;let d;if("ws:"===s.protocol||n||a?a&&!s.pathname?d="The URL's pathname is empty":s.hash&&(d="The URL contains a fragment identifier"):d='The URL\'s protocol must be one of "ws:", "wss:", "http:", "https", or "ws+unix:"',d){const t=new SyntaxError(d);if(0===e._redirects)throw t;return void Lt(e,t)}const h=n?443:80,l=tt(16).toString("base64"),c=n?Je.request:Ze.request,u=new Set;let f,m;if(o.createConnection=o.createConnection||(n?Nt:Ct),o.defaultPort=o.defaultPort||h,o.port=s.port||h,o.host=s.hostname.startsWith("[")?s.hostname.slice(1,-1):s.hostname,o.headers={...o.headers,"Sec-WebSocket-Version":o.protocolVersion,"Sec-WebSocket-Key":l,Connection:"Upgrade",Upgrade:"websocket"},o.path=s.pathname+s.search,o.timeout=o.handshakeTimeout,o.perMessageDeflate&&(f=new ot(!0!==o.perMessageDeflate?o.perMessageDeflate:{},!1,o.maxPayload),o.headers["Sec-WebSocket-Extensions"]=yt({[ot.extensionName]:f.offer()})),i.length){for(const e of i){if("string"!=typeof e||!xt.test(e)||u.has(e))throw new SyntaxError("An invalid or duplicated subprotocol was specified");u.add(e)}o.headers["Sec-WebSocket-Protocol"]=i.join(",")}if(o.origin&&(o.protocolVersion<13?o.headers["Sec-WebSocket-Origin"]=o.origin:o.headers.Origin=o.origin),(s.username||s.password)&&(o.auth=`${s.username}:${s.password}`),a){const e=o.path.split(":");o.socketPath=e[0],o.path=e[1]}if(o.followRedirects){if(0===e._redirects){e._originalIpc=a,e._originalSecure=n,e._originalHostOrSocketPath=a?o.socketPath:s.host;const t=r&&r.headers;if(r={...r,headers:{}},t)for(const[e,i]of Object.entries(t))r.headers[e.toLowerCase()]=i}else if(0===e.listenerCount("redirect")){const t=a?!!e._originalIpc&&o.socketPath===e._originalHostOrSocketPath:!e._originalIpc&&s.host===e._originalHostOrSocketPath;(!t||e._originalSecure&&!n)&&(delete o.headers.authorization,delete o.headers.cookie,t||delete o.headers.host,o.auth=void 0)}o.auth&&!r.headers.authorization&&(r.headers.authorization="Basic "+Buffer.from(o.auth).toString("base64")),m=e._req=c(o),e._redirects&&e.emit("redirect",e.url,m)}else m=e._req=c(o);o.timeout&&m.on("timeout",(()=>{Pt(e,m,"Opening handshake has timed out")})),m.on("error",(t=>{null===m||m[kt]||(m=e._req=null,Lt(e,t))})),m.on("response",(s=>{const n=s.headers.location,a=s.statusCode;if(n&&o.followRedirects&&a>=300&&a<400){if(++e._redirects>o.maxRedirects)return void Pt(e,m,"Maximum redirects exceeded");let s;m.abort();try{s=new rt(n,t)}catch(t){const i=new SyntaxError(`Invalid URL: ${n}`);return void Lt(e,i)}Tt(e,s,i,r)}else e.emit("unexpected-response",m,s)||Pt(e,m,`Unexpected server response: ${s.statusCode}`)})),m.on("upgrade",((t,i,r)=>{if(e.emit("upgrade",t),e.readyState!==Ot.CONNECTING)return;m=e._req=null;const s=t.headers.upgrade;if(void 0===s||"websocket"!==s.toLowerCase())return void Pt(e,i,"Invalid Upgrade header");const n=it("sha1").update(l+lt).digest("base64");if(t.headers["sec-websocket-accept"]!==n)return void Pt(e,i,"Invalid Sec-WebSocket-Accept header");const a=t.headers["sec-websocket-protocol"];let d;if(void 0!==a?u.size?u.has(a)||(d="Server sent an invalid subprotocol"):d="Server sent a subprotocol but none was requested":u.size&&(d="Server sent no subprotocol"),d)return void Pt(e,i,d);a&&(e._protocol=a);const h=t.headers["sec-websocket-extensions"];if(void 0!==h){if(!f){return void Pt(e,i,"Server sent a Sec-WebSocket-Extensions header but no extension was requested")}let t;try{t=gt(h)}catch(t){return void Pt(e,i,"Invalid Sec-WebSocket-Extensions header")}const r=Object.keys(t);if(1!==r.length||r[0]!==ot.extensionName){return void Pt(e,i,"Server indicated an extension that was not requested")}try{f.accept(t[ot.extensionName])}catch(t){return void Pt(e,i,"Invalid Sec-WebSocket-Extensions header")}e._extensions[ot.extensionName]=f}e.setSocket(i,r,{allowSynchronousEvents:o.allowSynchronousEvents,generateMask:o.generateMask,maxPayload:o.maxPayload,skipUTF8Validation:o.skipUTF8Validation})})),o.finishRequest?o.finishRequest(m,e):m.end()}function Lt(e,t){e._readyState=Ot.CLOSING,e._errorEmitted=!0,e.emit("error",t),e.emitClose()}function Ct(e){return e.path=e.socketPath,Qe.connect(e)}function Nt(e){return e.path=void 0,e.servername||""===e.servername||(e.servername=Qe.isIP(e.host)?"":e.host),et.connect(e)}function Pt(e,t,i){e._readyState=Ot.CLOSING;const r=new Error(i);Error.captureStackTrace(r,Pt),t.setHeader?(t[kt]=!0,t.abort(),t.socket&&!t.socket.destroyed&&t.socket.destroy(),process.nextTick(Lt,e,r)):(t.destroy(r),t.once("error",e.emit.bind(e,"error")),t.once("close",e.emitClose.bind(e)))}function Bt(e,t,i){if(t){const i=at(t)?t.size:bt(t).length;e._socket?e._sender._bufferedBytes+=i:e._bufferedAmount+=i}if(i){const t=new Error(`WebSocket is not open: readyState ${e.readyState} (${Et[e.readyState]})`);process.nextTick(i,t)}}function Rt(e,t){const i=this[mt];i._closeFrameReceived=!0,i._closeMessage=t,i._closeCode=e,void 0!==i._socket[mt]&&(i._socket.removeListener("data",zt),process.nextTick(Ft,i._socket),1005===e?i.close():i.close(e,t))}function At(){const e=this[mt];e.isPaused||e._socket.resume()}function Ut(e){const t=this[mt];void 0!==t._socket[mt]&&(t._socket.removeListener("data",zt),process.nextTick(Ft,t._socket),t.close(e[ft])),t._errorEmitted||(t._errorEmitted=!0,t.emit("error",e))}function It(){this[mt].emitClose()}function Wt(e,t){this[mt].emit("message",e,t)}function Mt(e){const t=this[mt];t._autoPong&&t.pong(e,!this._isServer,pt),t.emit("ping",e)}function Dt(e){this[mt].emit("pong",e)}function Ft(e){e.resume()}function jt(e){const t=this[mt];t.readyState!==Ot.CLOSED&&(t.readyState===Ot.OPEN&&(t._readyState=Ot.CLOSING,qt(t)),this._socket.end(),t._errorEmitted||(t._errorEmitted=!0,t.emit("error",e)))}function qt(e){e._closeTimer=setTimeout(e._socket.destroy.bind(e._socket),wt)}function Gt(){const e=this[mt];let t;this.removeListener("close",Gt),this.removeListener("data",zt),this.removeListener("end",Kt),e._readyState=Ot.CLOSING,this._readableState.endEmitted||e._closeFrameReceived||e._receiver._writableState.errorEmitted||null===(t=e._socket.read())||e._receiver.write(t),e._receiver.end(),this[mt]=void 0,clearTimeout(e._closeTimer),e._receiver._writableState.finished||e._receiver._writableState.errorEmitted?e.emitClose():(e._receiver.on("error",It),e._receiver.on("finish",It))}function zt(e){this[mt]._receiver.write(e)||this.pause()}function Kt(){const e=this[mt];e._readyState=Ot.CLOSING,e._receiver.end(),this.end()}function Vt(){const e=this[mt];this.removeListener("error",Vt),this.on("error",pt),e&&(e._readyState=Ot.CLOSING,this.destroy())}Object.defineProperty(Ot,"CONNECTING",{enumerable:!0,value:Et.indexOf("CONNECTING")}),Object.defineProperty(Ot.prototype,"CONNECTING",{enumerable:!0,value:Et.indexOf("CONNECTING")}),Object.defineProperty(Ot,"OPEN",{enumerable:!0,value:Et.indexOf("OPEN")}),Object.defineProperty(Ot.prototype,"OPEN",{enumerable:!0,value:Et.indexOf("OPEN")}),Object.defineProperty(Ot,"CLOSING",{enumerable:!0,value:Et.indexOf("CLOSING")}),Object.defineProperty(Ot.prototype,"CLOSING",{enumerable:!0,value:Et.indexOf("CLOSING")}),Object.defineProperty(Ot,"CLOSED",{enumerable:!0,value:Et.indexOf("CLOSED")}),Object.defineProperty(Ot.prototype,"CLOSED",{enumerable:!0,value:Et.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach((e=>{Object.defineProperty(Ot.prototype,e,{enumerable:!0})})),["open","error","close","message"].forEach((e=>{Object.defineProperty(Ot.prototype,`on${e}`,{enumerable:!0,get(){for(const t of this.listeners(e))if(t[ct])return t[ut];return null},set(t){for(const t of this.listeners(e))if(t[ct]){this.removeListener(e,t);break}"function"==typeof t&&this.addEventListener(e,t,{[ct]:!0})}})})),Ot.prototype.addEventListener=_t,Ot.prototype.removeEventListener=vt;var $t=w(Ot);
/**
 * Scraped By Kaviaann
 * Protected By MIT LICENSE
 * Whoever caught removing wm will be sued
 * @description Any Request? Contact me : vielynian@gmail.com
 * @author Kaviaann 2024
 * @copyright https://whatsapp.com/channel/0029Vac0YNgAjPXNKPXCvE2e
 */var Ht=Object.freeze({__proto__:null,englishAi:function(){return p(this,arguments,void 0,(function*(e=[{content:"you are vielyn, your goal is to help the user about their problems",role:"user"},{content:"hi! what can i help you today?⭐",role:"assistant",refusal:null},{content:"what is your name?",role:"user"}]){return new Promise(((t,r)=>p(this,void 0,void 0,(function*(){var o;try{if(!e||!Array.isArray(e)||e.length<1)return r(Error("Enter valid chat object [ IEnglishAiChat ]"));const s=yield i.post("https://api.deepenglish.com/api/gpt/chat",{messages:e,temperature:.9},{headers:{Origin:"https://members.deepenglish.com",Referer:"https://members.deepenglish.com/",Host:"api.deepenglish.com","User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36"}}).then((e=>e.data)),n=e;return yield n.push(yield s.data.choices.shift().message),yield t({history:[...n],response:(yield null===(o=n.pop())||void 0===o?void 0:o.content)||""})}catch(e){r(e)}}))))}))},fluxGen:function(e){return p(this,void 0,void 0,(function*(){return new Promise(((t,i)=>p(this,void 0,void 0,(function*(){try{const o=e=>new Promise((e=>setTimeout(e,5e3))),s=new $t("wss://ws-api.runware.ai/v1"),n={},a=[];return s.on("open",(()=>p(this,void 0,void 0,(function*(){for(s.on("message",((e,t)=>{const i=JSON.parse(Buffer.from(e).toString("utf8")).data[0];"authentication"===i.taskType&&(n.uuid=i.connectionSessionUUID),"imageInference"===i.taskType&&a.push({isNSFW:i.NSFWContent,imageURI:i.imageDataURI,imageURL:i.imageURL})})),s.send(JSON.stringify([{apiKey:"z1ilk4CqKMMMPSm3gynSdrsuoKsECcxK",taskType:"authentication"}]),(e=>{if(e)return i(new Error("Fail to init authentication!"))}));!n.uuid;)yield o(1e3);for(s.send(JSON.stringify([{taskType:"imageInference",model:"runware:100@1",positivePrompt:e,height:512,width:512,numberResults:2,outputType:["dataURI","URL"],outputFormat:"WEBP",taskUUID:r()}]),(e=>{if(e)return i(new Error("Fail to send image request"))})),setTimeout((()=>{!a.length&&i(new Error("Timeout making images!"))}),15e3);!a.length;)yield o(2500);return t({prompt:e,total:a.length,images:a})})))),s}catch(e){return i(e)}}))))}))}}),Yt=Object.freeze({__proto__:null,Ai:Ht,Anime:y,Downloader:b,Tools:g});var Xt=Object.freeze({__proto__:null,delay:function(e){return p(this,void 0,void 0,(function*(){return new Promise((t=>p(this,void 0,void 0,(function*(){setTimeout((()=>t()),e)}))))}))},generateId:function(e){return p(this,void 0,void 0,(function*(){const t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890+=";let i="",r=0;for(;r<e;)i+=t[Math.floor(64*Math.random())],r++;return i}))}});export{Xt as Function,Yt as Scraper};
//# sourceMappingURL=index.mjs.map
