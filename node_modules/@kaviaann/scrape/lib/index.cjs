"use strict";var e=require("cheerio"),t=require("form-data"),i=require("axios"),r=require("node:crypto"),s=require("yt-search"),o=require("stream"),n=require("zlib"),a=require("buffer"),d=require("crypto"),h=require("events"),l=require("https"),c=require("http"),u=require("net"),f=require("tls"),m=require("url");function p(e){var t=Object.create(null);return e&&Object.keys(e).forEach((function(i){if("default"!==i){var r=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(t,i,r.get?r:{enumerable:!0,get:function(){return e[i]}})}})),t.default=e,Object.freeze(t)}var _=p(e);function v(e,t,i,r){return new(i||(i=Promise))((function(s,o){function n(e){try{d(r.next(e))}catch(e){o(e)}}function a(e){try{d(r.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(n,a)}d((r=r.apply(e,t||[])).next())}))}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function g(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,i=e[Symbol.asyncIterator];return i?i.call(e):(e=y(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(i){t[i]=e[i]&&function(t){return new Promise((function(r,s){(function(e,t,i,r){Promise.resolve(r).then((function(t){e({value:t,done:i})}),t)})(r,s,(t=e[i](t)).done,t.value)}))}}}"function"==typeof SuppressedError&&SuppressedError;var b=Object.freeze({__proto__:null,Kuronime:
/**
 * Scraped By Kaviaann
 * Protected By MIT LICENSE
 * Whoever caught removing wm will be sued
 * @description Any Request? Contact me : vielynian@gmail.com
 * @author Kaviaann 2024
 * @copyright https://whatsapp.com/channel/0029Vac0YNgAjPXNKPXCvE2e
 */
class{constructor(){this.BASE_URL="https://kuronime.me"}search(e){return v(this,void 0,void 0,(function*(){return new Promise(((t,r)=>v(this,void 0,void 0,(function*(){try{const s=yield i.post(this.BASE_URL+"/wp-admin/admin-ajax.php",new URLSearchParams({action:"ajaxy_sf",sf_value:e,search:"false"}),{headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36","x-requested-with":"XMLHttpRequest","sec-ch-ua":'"Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"',origin:this.BASE_URL}}).then((e=>e.data)).then((e=>{var t;return null===(t=e.anime)||void 0===t?void 0:t[0]}));if(!s)return r("Query Not Found");if(s.result=yield Promise.all(s.all.map((e=>v(this,void 0,void 0,(function*(){var t,i,r,s;delete e.post_image_html;try{for(var o,n=!0,a=g(Object.keys(e));!(t=(o=yield a.next()).done);n=!0){s=o.value,n=!1;let t=s;t.includes("post_")?(e[t.replace("post_","")]=e[t],delete e[t]):"ID"===t&&(e[t.toLocaleLowerCase()]=e[t],delete e[t])}}catch(e){i={error:e}}finally{try{n||t||!(r=a.return)||(yield r.call(a))}finally{if(i)throw i.error}}return e}))))),delete s.all,delete s.template,delete s.title,delete s.class_name,!s.result.length)return r("Anime Not Found");s.total=s.result.length,s.query=e,t(s)}catch(e){r(e)}}))))}))}detail(e){return v(this,void 0,void 0,(function*(){return new Promise(((t,r)=>v(this,void 0,void 0,(function*(){var s,o,n,a;try{if(!/kuronime\.\w+\/anime/i.test(e))return r("Enter valid kuronime URL!");const d=yield i.get(e,{headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36"}}).then((e=>e.data)).then((e=>_.load(e))),h=d("body").find(".postbody > article"),l={title:d(h).find('.info-header > h1[itemprop="name"]').text().trim(),thumbnail:(null===(o=null===(s=d(h).find(".entry-content > .main-info > .con > div.l > img").attr("data-src"))||void 0===s?void 0:s.split("?"))||void 0===o?void 0:o[0])||"",trailer:d(h).find(".trailer").find("iframe").attr("data-src")||"",id:(null===(n=h.attr("id"))||void 0===n?void 0:n.replace("post-",""))||"",synops:d(h).find(".main-info > .con > .r > .conx > .const").text().trim(),author:d(h).find('.info-header > .year > [itemprop="author"]').text().trim(),updated:d(h).find(".info-header > .year span.updated").text().trim(),views:d(h).find(".tab > .tabx > div.post-views > .post-views-count").text().trim(),followers:null===(a=d(h).find(".main-info > .con > .r > .conx > .rt > .bmc").text().trim())||void 0===a?void 0:a.split(" ")[1],rating:d(h).find(".main-info > .con > .r > .conx > .rt > .rating > strong").text().trim().split(" ")[1],detail:d(h).find(".infodetail > ul > li").map(((e,t)=>({name:d(t).find("b").text().trim().toLowerCase().replace(" on",""),data:d(t).text().trim().replace(d(t).find("b").text().trim()+": ","")}))).get(),episode:d(h).find(".bxcl > ul > li").map(((e,t)=>({title:d(t).find(".lchx > a").text().trim(),link:d(t).find(".lchx > a").attr("href")||""}))).get()};t(l)}catch(e){r(e)}}))))}))}},Samehadaku:
/**
 * Scraped By Kaviaann
 * Protected By MIT LICENSE
 * Whoever caught removing wm will be sued
 * @description Any Request? Contact me : vielynian@gmail.com
 * @author Kaviaann 2024
 * @copyright https://whatsapp.com/channel/0029Vac0YNgAjPXNKPXCvE2e
 */
class{constructor(){this.BASE_URL="https://samehadaku.email"}search(e){return v(this,void 0,void 0,(function*(){return new Promise(((t,r)=>v(this,void 0,void 0,(function*(){try{const s=yield i.get(this.BASE_URL+"/?"+new URLSearchParams({s:e}));if("OK"!==s.statusText)return r("Fail Fetching");const o=_.load(s.data);if(o("main#main").find(".notfound").length)return r("Query Not Found");const n=[];o("main#main").find("article.animpost").each(((e,t)=>{var i,r;n.push({title:null===(i=o(t).find("img").attr("title"))||void 0===i?void 0:i.trim(),id:(null===(r=o(t).attr("id"))||void 0===r?void 0:r.split("-")[1])||"",thumbnail:o(t).find("img").attr("src")||"",description:o(t).find("div.ttls").text().trim(),genre:o(t).find("div.genres > .mta > a").map(((e,t)=>o(t).text().trim())).get(),type:o(t).find("div.type").map(((e,t)=>o(t).text().trim())).get(),star:o(t).find("div.score").text().trim(),views:o(t).find("div.metadata > span").eq(2).text().trim(),link:o(t).find("a").attr("href")||""})})),t(n)}catch(e){r(e)}}))))}))}latest(){return v(this,void 0,void 0,(function*(){return new Promise(((e,t)=>v(this,void 0,void 0,(function*(){try{const r="https://samehadaku.email/anime-terbaru/",s=yield i.get(r,{headers:{"user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36"}});if("OK"!==s.statusText)return t("Website Down");const o=_.load(s.data),n=o("div.post-show > ul").children("li"),a={total:0,anime:[]};for(let e of n)a.anime.push({title:o(e).find("h2.entry-title").text().trim().split(" Episode")[0],thumbnail:o(e).find("div.thumb > a > img").attr("src")||"",postedBy:o(e).find('span[itemprop="author"] > author').text().trim(),episode:o(e).find("span").eq(0).find("author").text().trim(),release:o(e).find('span[itemprop="author"]').next().contents().eq(3).text().split(": ")[1].trim(),link:o(e).find("a").attr("href")||""});a.total=a.anime.length,e(a)}catch(e){t(e)}}))))}))}release(){return v(this,void 0,void 0,(function*(){return new Promise(((e,t)=>v(this,void 0,void 0,(function*(){var r,s,o,n;try{const t={sunday:[],monday:[],tuesday:[],wednesday:[],thursday:[],friday:[],saturday:[]};try{for(var a,d=!0,h=g(Object.keys(t));!(r=(a=yield h.next()).done);d=!0){n=a.value,d=!1;let e=n;const r=yield i.get(this.BASE_URL+"/wp-json/custom/v1/all-schedule?"+new URLSearchParams({perpage:"20",day:e,type:"schtml"})).then((e=>e.data));t[e]=r}}catch(e){s={error:e}}finally{try{d||r||!(o=h.return)||(yield o.call(h))}finally{if(s)throw s.error}}e(t)}catch(e){t(e)}}))))}))}detail(e){return v(this,void 0,void 0,(function*(){return new Promise(((t,r)=>v(this,void 0,void 0,(function*(){try{if(!e.match(/samehadaku\.\w+\/anime/gi))return r("Invalid URL");const s=yield i.get(e);if("OK"!==s.statusText)return r("Fail Fetching");const o=_.load(s.data),n={title:o('.infoanime > h1[itemprop="name"]').text().trim().replace("Nonton Anime ",""),thumbnail:o(".infoanime > .thumb > img").attr("src")||"",published:new Date(o(".anim-senct").find("time").attr("datetime")||""),trailer:o(".trailer-anime").find("iframe").attr("src")||"",rating:o(".infoanime").find('span[itemprop="ratingValue"]').text().trim()+"/"+o(".infoanime").find('i.hidden[itemprop="ratingCount"]').attr("content"),description:o(".infox > .desc").text().trim(),genre:o(".infox > .genre-info > a").map(((e,t)=>o(t).text().trim())).get(),detail:o("h3.anim-detail").next().find("span").map(((e,t)=>({name:o(t).find("b").text().trim(),data:`${o(t).text().trim()}`.replace(o(t).find("b").text().trim()+" ","").trim()}))).get(),batch:o(".listbatch").find("a").attr("href")||null,episode:o(".lstepsiode > ul > li").map(((e,t)=>({title:o(t).find(".lchx > a").text().trim(),date:o(t).find(".date").text().trim(),link:o(t).find(".eps > a").attr("href")||""}))).get()};t(n)}catch(e){r(e)}}))))}))}download(e){return v(this,void 0,void 0,(function*(){return new Promise(((r,s)=>v(this,void 0,void 0,(function*(){try{if(!/samehadaku\.\w+\/[\w-]+episode/gi.test(e))return s("Invalid URL!");const o=yield i.get(e,{headers:{"user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36"}});if("OK"!==o.statusText)return s("Error Fetching");const n=_.load(o.data),a={title:n('h1[itemprop="name"]').text().trim(),link:e,downloads:[]};return a.downloads=yield Promise.all(n("div#server > ul > li").map(((e,r)=>v(this,void 0,void 0,(function*(){const e={name:n(r).find("span").text().trim(),post:n(r).find("div").attr("data-post")||"",nume:n(r).find("div").attr("data-nume")||"",type:n(r).find("div").attr("data-type")||"",link:""},s=new t;return s.append("action","player_ajax"),s.append("post",e.post),s.append("nume",e.nume),s.append("type",e.type),e.link=(yield i.post("https://samehadaku.email/wp-admin/admin-ajax.php",s,{headers:{"user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36",origin:"https://samehadaku.email"}}).then((e=>e.data)).then((e=>_.load(e)("iframe").attr("src"))))||"",e}))))),r(a)}catch(e){s(e)}}))))}))}}});
/**
 * Scraped By Kaviaann
 * Protected By MIT LICENSE
 * Whoever caught removing wm will be sued
 * @description Any Request? Contact me : vielynian@gmail.com
 * @author Kaviaann 2024
 * @copyright https://whatsapp.com/channel/0029Vac0YNgAjPXNKPXCvE2e
 */var w=Object.freeze({__proto__:null,Mlbb:
/**
 * Scraped By Kaviaann
 * Protected By MIT LICENSE
 * Whoever caught removing wm will be sued
 * @description Any Request? Contact me : vielynian@gmail.com
 * @author Kaviaann 2024
 * @copyright https://whatsapp.com/channel/0029Vac0YNgAjPXNKPXCvE2e
 */
class{constructor(){}latestHero(){return v(this,void 0,void 0,(function*(){return new Promise(((e,t)=>v(this,void 0,void 0,(function*(){try{const r={Accept:"application/json, text/plain, */*",Authorization:"ihm6nDSwFbknXGFFP+4nXrplZ5Y=",origin:"https://m.mobilelegends.com",referer:"https://m.mobilelegends.com/","User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36","x-actid":2669607,"x-appid":2669606,"x-lang":"en"},s={filters:[],object:[],pageIndex:1,pageSize:6,sorts:[{data:{field:"hero_id",order:"desc"},type:"sequence"}]},o=yield i.post("https://api.gms.moontontech.com/api/gms/source/2669606/2756564",s,{headers:r}).then((e=>e.data)).then((e=>e.data.records.map((e=>e.data)))).catch((e=>null));if(!o)return t(Error("Fail to get latest hero"));e({total:o.length,data:o.map((e=>{const t=e.hero.data,i={name:t.name,id:t.heroid,media:{icon:t.head,png:t.painting,potrait:t.smallmap,head:t.squarehead,header:t.squareheadbig},createdAt:e.hero._createdAt,updatedAt:e.hero._updatedAt,story:t.story,tale:t.tale||"",sourceId:e.hero.sourceId,link:e.url,lane:t.roadsort.filter((e=>e)).map((e=>({name:e.data.road_sort_title,id:e.data.road_sort_id,icon:e.data.road_sort_icon}))),role:t.sortid.filter((e=>e)).map((e=>({name:e.data.sort_title,id:e.data.sort_id,icon:e.data.sort_icon}))),ability:{durability:t.abilityshow[0],offense:t.abilityshow[1],ability_effects:t.abilityshow[2],difficulty:t.abilityshow[3]},skill:t.heroskilllist.filter((e=>e)).map((e=>e.skilllist.map((e=>{const t={name:e.skillname,id:e.skillid,icon:e.skillicon,desc:e.skilldesc.replace(/<\/?[^>]+(>|$)/g,""),update:e.skilltag,video:e.skillvideo,cd:""};return e["skillcd&cost"].split("   ").forEach((e=>{const i=e.split(": "),r=i[0].trim().toLowerCase().replace(/ /gi,"_");t[r]=i[1]})),t})))),speciality:t.speciality,difficulty:t.difficulty,relation:e.relation,level:t.recommendlevel};return i}))})}catch(e){return t(e)}}))))}))}}
/**
 * Scraped By Kaviaann
 * Protected By MIT LICENSE
 * Whoever caught removing wm will be sued
 * @description Any Request? Contact me : vielynian@gmail.com
 * @author Kaviaann 2024
 * @copyright https://whatsapp.com/channel/0029Vac0YNgAjPXNKPXCvE2e
 */,Saweria:class{constructor(){this.BASE_URL="https://saweria.co",this.BACKEND="https://backend.saweria.co",this.token="",this.saweria=""}login(e,t){return v(this,void 0,void 0,(function*(){return new Promise(((r,s)=>v(this,void 0,void 0,(function*(){try{const s=yield i.post(this.BACKEND+"/auth/login",{email:e,password:t});this.setToken(s.headers.authorization),this.setSaweria(s.data.data.username),r(Object.assign({authorization:s.headers.authorization},s.data))}catch(e){s("Incorrect Email Or Password")}}))))}))}register(e){return v(this,void 0,void 0,(function*(){return new Promise(((t,r)=>v(this,void 0,void 0,(function*(){try{const r=yield i.post(this.BACKEND+"/auth/register",{email:e,currency:"IDR"},{headers:{origin:this.BASE_URL}});t({success:!0,data:"Check Email On "+r.data.data.email,email:r.data.data.email})}catch(t){r({success:!1,data:"Email Is Taken",email:e})}}))))}))}getUser(){return v(this,void 0,void 0,(function*(){return new Promise(((e,t)=>v(this,void 0,void 0,(function*(){try{if(!this.token)return t("Please login first or setup token manually");const r=yield i.get(this.BACKEND+"/users",{headers:{Authorization:this.token,origin:this.BASE_URL}});e(r.data.data)}catch(e){t(e)}}))))}))}getSaweria(e){return v(this,void 0,void 0,(function*(){return new Promise(((t,r)=>v(this,void 0,void 0,(function*(){try{if(!/saweria\.co\/\w+/gi.test(e))return r("Invalid URL");const s=yield i.get(e).then((e=>e.data)).then((e=>_.load(e)("script#__NEXT_DATA__").text().trim())).then((e=>JSON.parse(e))).then((e=>e.props.pageProps.data));t(s)}catch(e){r(e)}}))))}))}setToken(e){return v(this,void 0,void 0,(function*(){this.token=e}))}setSaweria(e){return v(this,void 0,void 0,(function*(){this.saweria="https://saweria.co/"+e}))}createPayment(){return v(this,arguments,void 0,(function*(e=1e3,t="hi",r=this.token){return new Promise(((r,s)=>v(this,void 0,void 0,(function*(){try{if(!this.token)return s("Login Required");if(e<1e3)return s("Invalid Amount Of Money, Enter More Or Equal To 1000 RP");const o=yield this.getUser(),n=yield i.post(this.BACKEND+"/donations/"+o.id,{agree:!0,amount:e,currency:"IDR",customer_info:{first_name:o.username,email:o.email,phone:""},message:t,notUnderage:!0,payment_type:"qris",vote:""},{headers:{origin:this.BASE_URL,Authorization:this.token,"Content-Type":"application/json"}});r(Object.assign({link:this.BASE_URL+"/qris/"+n.data.data.id},n.data))}catch(e){s(e)}}))))}))}sendPayment(e){return v(this,arguments,void 0,(function*(e,t=1e3,i="hi"){return new Promise(((r,s)=>v(this,void 0,void 0,(function*(){try{const s=yield this.getSaweria(e);r(yield this.createPayment(t,i,s.id))}catch(e){s(e)}}))))}))}status(e){return v(this,void 0,void 0,(function*(){return new Promise(((t,r)=>v(this,void 0,void 0,(function*(){try{const r=yield i.get(this.BACKEND+"/donations/qris/"+e).then((e=>e.data));t(Object.assign({id:e,done:""===r.data.qr_string},r))}catch(e){r(e)}}))))}))}getBalance(){return v(this,void 0,void 0,(function*(){return new Promise(((e,t)=>v(this,void 0,void 0,(function*(){try{if(!this.token)return t("Login to your saweria account first");const{data:r}=yield i.get(this.BACKEND+"/donations/balance",{headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36",Authorization:this.token,origin:this.BASE_URL}});e(r.data)}catch(e){t(e)}}))))}))}getTransaction(){return v(this,arguments,void 0,(function*(e=1){return new Promise(((t,r)=>v(this,void 0,void 0,(function*(){try{if(!this.token)return r("Login to your saweria account first");const{data:s}=yield i.get(this.BACKEND+"/transactions?page="+e+"&page_size=15",{headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36",Authorization:this.token,origin:this.BASE_URL}});t({total:s.data.transactions.length,data:s.data.transactions.map((e=>(delete e.amount_raw,delete e.etc,delete e.failure_code,Object.assign({},e))))})}catch(e){r(e)}}))))}))}}
/**
 * Scraped By Kaviaann
 * Protected By MIT LICENSE
 * Whoever caught removing wm will be sued
 * @description Any Request? Contact me : vielynian@gmail.com
 * @author Kaviaann 2024
 * @copyright https://whatsapp.com/channel/0029Vac0YNgAjPXNKPXCvE2e
 */,ffStalk:function(e){return v(this,void 0,void 0,(function*(){return new Promise(((t,s)=>v(this,void 0,void 0,(function*(){try{const o={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36","X-Device":r.randomUUID()},n=yield i.post("https://api.duniagames.co.id/api/item-catalog/v1/get-token",{msisdn:"0812665588"},{headers:o}).then((e=>e.data)).then((e=>e.status.code?s(Error("Fail initializing token")):e.data.token)),a=yield i.post("https://api.duniagames.co.id/api/transaction/v1/top-up/inquiry/store",{productId:3,itemId:353,product_ref:"REG",product_ref_denom:"REG",catalogId:376,paymentId:1252,gameId:e,token:n,campaignUrl:""},{headers:o}).then((e=>e.data)).then((e=>e.data.gameDetail.userName));return t({id:e,name:a})}catch(e){return s(e)}}))))}))},postid:function(e){return v(this,void 0,void 0,(function*(){return new Promise(((t,r)=>v(this,void 0,void 0,(function*(){var s;try{const r=yield i.get("https://kodeposku.com/cari?"+new URLSearchParams({q:String(e),_rsc:"1mart"}),{headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.0.0 Safari/537.36",rsc:1,"next-url":"/cari","next-router-state-tree":"%5B%22%22%2C%7B%22children%22%3A%5B%22(application)%22%2C%7B%22children%22%3A%5B%22cari%22%2C%7B%22children%22%3A%5B%22__PAGE__%3F%7B%5C%22q%5C%22%3A%5C%227371%5C%22%7D%22%2C%7B%7D%5D%7D%5D%7D%5D%7D%2Cnull%2Cnull%2Ctrue%5D"}}).then((e=>e.data)).catch((e=>e.response.data));return t(JSON.parse((null===(s=/{"villages":(\[(?:{"id":.*?,"kode_kemendagri":".*?","kode_pos":.*?,"kelurahan":".*?","kecamatan":".*?","kota":".*?","provinsi":".*?","zona_waktu":".*?","lintang":.*?,"bujur":.*?,"elevasi":.*?},?)\])/g.exec(r))||void 0===s?void 0:s[1])||"[]"))}catch(e){return r(e)}}))))}))}});
/**
 * Scraped By Kaviaann
 * Protected By MIT LICENSE
 * Whoever caught removing wm will be sued
 * @description Any Request? Contact me : vielynian@gmail.com
 * @author Kaviaann 2024
 * @copyright https://whatsapp.com/channel/0029Vac0YNgAjPXNKPXCvE2e
 */var k=Object.freeze({__proto__:null,drive:
/**
 * Scraped By Kaviaann
 * Protected By MIT LICENSE
 * Whoever caught removing wm will be sued
 * @description Any Request? Contact me : vielynian@gmail.com
 * @author Kaviaann 2024
 * @copyright https://whatsapp.com/channel/0029Vac0YNgAjPXNKPXCvE2e
 */
function(e){return v(this,void 0,void 0,(function*(){return new Promise(((t,r)=>v(this,void 0,void 0,(function*(){var s,o;try{if(!e.match(/drive\.google\.com\/file/i))return r("Invalid URL!");const n=yield i.get(e,{headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36"}}).then((e=>e.data)),a=_.load(n),d={name:a("head").find('meta[property="og:title"]').attr("content")||"",link:(null===(s=a("head").find('meta[property="og:url"]').attr("content"))||void 0===s?void 0:s.split("?")[0])||e,download:"https://drive.usercontent.google.com/u/0/uc?"+new URLSearchParams({id:(null===(o=e.match(/file\/d\/([\w\d-]+)/i))||void 0===o?void 0:o[1])||""})};t(d)}catch(e){r(e)}}))))}))}
/**
 * Scraped By Kaviaann
 * Protected By MIT LICENSE
 * Whoever caught removing wm will be sued
 * @description Any Request? Contact me : vielynian@gmail.com
 * @author Kaviaann 2024
 * @copyright https://whatsapp.com/channel/0029Vac0YNgAjPXNKPXCvE2e
 */,facebook:
/**
 * Scraped By Kaviaann
 * Protected By MIT LICENSE
 * Whoever caught removing wm will be sued
 * @description Any Request? Contact me : vielynian@gmail.com
 * @author Kaviaann 2024
 * @copyright https://whatsapp.com/channel/0029Vac0YNgAjPXNKPXCvE2e
 */
function(e){return v(this,void 0,void 0,(function*(){return new Promise(((t,r)=>v(this,void 0,void 0,(function*(){var s,o;try{if(!e.match(/facebook\.\w+\/(reel|watch|share)/gi))return r("Invalid URL, Enter A Valid Facebook Video URL");const n=yield i.get("https://fdownloader.net/id",{headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36"}}).then((e=>e.data)),a=/k_exp ?= ?"(\d+)"/i,d=/k_token ?= ?"([a-f0-9]+)"/i,h=null===(s=n.match(a))||void 0===s?void 0:s[1],l=null===(o=n.match(d))||void 0===o?void 0:o[1];if(!h||!l)return r("Error Extracting Exp And Token");const c=yield i.post("https://v3.fdownloader.net/api/ajaxSearch?lang=id",new URLSearchParams({k_exp:h,k_token:l,q:e,lang:"id",web:"fdownloader.net",v:"v2",w:""}),{headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36",origin:"https://fdownloader.net"}}).then((e=>e.data));if("ok"!==c.status)return r("Failed Doing Ajax Search");const u=_.load(c.data),f=_.load(u(".detail").html()||""),m={title:f(".thumbnail > .content > .clearfix > h3").text().trim(),duration:f(".thumbnail > .content > .clearfix > p").text().trim(),thumbnail:f(".thumbnail > .image-fb > img").attr("src")||"",media:f("#popup_play > .popup-body > .popup-content > #vid").attr("src")||"",video:f("#fbdownloader").find(".tab__content").eq(0).find("tr").map(((e,t)=>{const i={quality:f(t).find(".video-quality").text().trim(),url:f(t).find("a").attr("href")||f(t).find("button").attr("data-videourl")||t};if("#note_convert"!==i.url)return i})).get(),music:f("#fbdownloader").find("#audioUrl").attr("value")||""};t(m)}catch(e){r(e)}}))))}))},spotify:function(e){return v(this,void 0,void 0,(function*(){return new Promise(((r,s)=>v(this,void 0,void 0,(function*(){try{const o=_.load((yield i.get("https://spotifymate.com/en",{headers:{cookie:"session_data=o8079end5j9oslm5a7bou84rqc;","User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36"}})).data),n={name:o("form#get_video").find('input[type="hidden"]').attr("name")||"",value:o("form#get_video").find('input[type="hidden"]').attr("value")||""},a=new t;a.append("url",e),a.append(n.name,n.value);let d=yield i.post("https://spotifymate.com/action",a,{headers:Object.assign(Object.assign({origin:"https://spotifymate.com/en"},a.getHeaders()),{cookie:"session_data=o8079end5j9oslm5a7bou84rqc;","User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36"})});if("OK"!==d.statusText)return s("Fail Fetching");const h=_.load(d.data),l={title:h(".dlvideos").find('h3[itemprop="name"]').text().trim(),author:h(".dlvideos").find(".spotifymate-downloader-middle > p > span").text().trim(),thumbnail:h(".dlvideos").find("img").attr("src")||"",cover:h(".dlvideos").find(".spotifymate-downloader-right").find("#none").eq(1).find("a").attr("href")||h(".dlvideos").find(".spotifymate-downloader-right").find("#pop").eq(1).find("a").attr("href")||"",music:h(".dlvideos").find(".spotifymate-downloader-right").find("#none").eq(0).find("a").attr("href")||h(".dlvideos").find(".spotifymate-downloader-right").find("#pop").eq(0).find("a").attr("href")||"",link:e};r(l)}catch(e){s(e)}}))))}))},youtube:function(e){return v(this,void 0,void 0,(function*(){return new Promise(((t,r)=>v(this,void 0,void 0,(function*(){var o;try{!(e=e.trim())&&r("Enter either a youtube link for downloading, or query for searching");if(/youtu(\.)?be/gi.test(e)){const n=(null===(o=/(?:youtu\.be\/|youtube\.com(?:\/(?:[^\/\n\s]+\/\S+\/|(?:v|e(?:mbed)?)\/|\S*?[?&]v=|shorts\/)|youtu\.be\/|embed\/|v\/|m\/|watch\?(?:[^=]+=[^&]+&)*?v=))([^"&?\/\s]{11})/gm.exec(e))||void 0===o?void 0:o[1])||"";if(!n)return r("Enter valid youtube video link!");const{title:a,description:d,url:h,videoId:l,seconds:c,timestamp:u,views:f,genre:m,uploadDate:p,ago:_,image:y,thumbnail:g,author:b}=yield s({videoId:n}),w={Accept:"*/*",Origin:"https://id-y2mate.com",Referer:"https://id-y2mate.com/","User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.0.0 Safari/537.36","Sec-Ch-Ua-Platform-Version":'"15.0.0"',"Sec-Ch-Ua-Bitness":"64","Sec-Ch-Ua-Model":"","Sec-Ch-Ua-Mobile":"?0","Sec-Ch-Ua-Arch":"x86","X-Requested-With":"XMLHttpRequest","Sec-Ch-Ua-Full-Version":"129.0.6668.90","Sec-Ch-Ua-Full-Version-List":'"Google Chrome";v="129.0.6668.90", "Not=A?Brand";v="8.0.0.0", "Chromium";v="129.0.6668.90"'},k=yield i.post("https://id-y2mate.com/mates/analyzeV2/ajax",new URLSearchParams({k_query:`https://youtube.com/watch?v=${n}`,k_page:"home",hl:"",q_auto:"0"}),{headers:w}).then((e=>e.data));if(!k)return r(new Error("Fail to get video & audio"));const S={mp3:{},mp4:{}};return yield new Promise((e=>{for(let e of Object.values(k.links.mp4))Object.assign(S.mp4,{[e.q]:()=>v(this,void 0,void 0,(function*(){return new Promise(((t,r)=>v(this,void 0,void 0,(function*(){try{const s=yield i.post("https://id-y2mate.com/mates/convertV2/index",new URLSearchParams({vid:n,k:e.k}),{headers:Object.assign(Object.assign({},w),{Referer:w.Referer+n})}).then((e=>e.data));return s&&"ok"===s.status?t({size:e.size,format:e.f,url:s.dlink}):r(new Error("Fail to convert video"))}catch(e){return r(e)}}))))}))});for(let e of Object.values(k.links.mp3))Object.assign(S.mp3,{[e.f]:()=>v(this,void 0,void 0,(function*(){return new Promise(((t,r)=>v(this,void 0,void 0,(function*(){try{const s=yield i.post("https://id-y2mate.com/mates/convertV2/index",new URLSearchParams({vid:n,k:e.k}),{headers:Object.assign(Object.assign({},w),{Referer:w.Referer+n})}).then((e=>e.data));return s&&"ok"===s.status?t({size:e.size,format:e.f,url:s.dlink}):r(new Error("Fail to convert video"))}catch(e){return r(e)}}))))}))});e()})),t({type:"download",download:{title:a,description:d,url:h,id:l,duration:{seconds:c,timestamp:u},views:f,genre:m,releaseDate:p,published:_,media:{thumbnail:g,image:y},author:b,dl:yield S}})}{const i=yield s(e).then((e=>e.videos));return t({type:"search",query:e,total:i.length||0,videos:i.map((({videoId:e,views:t,url:i,title:r,description:s,image:o,thumbnail:n,seconds:a,timestamp:d,ago:h,author:l})=>({title:r,id:e,url:i,media:{thumbnail:n||"",image:o},description:s,duration:{seconds:a,timestamp:d},published:h,views:t,author:l})))})}}catch(e){return r(e)}}))))}))}});
/**
 * Scraped By Kaviaann
 * Protected By MIT LICENSE
 * Whoever caught removing wm will be sued
 * @description Any Request? Contact me : vielynian@gmail.com
 * @author Kaviaann 2024
 * @copyright https://whatsapp.com/channel/0029Vac0YNgAjPXNKPXCvE2e
 */function S(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var E={exports:{}};const x=["nodebuffer","arraybuffer","fragments"],O="undefined"!=typeof Blob;O&&x.push("blob");var T={BINARY_TYPES:x,EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",hasBlob:O,kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}};const{EMPTY_BUFFER:L}=T,C=Buffer[Symbol.species];function N(e,t,i,r,s){for(let o=0;o<s;o++)i[r+o]=e[o]^t[3&o]}function P(e,t){for(let i=0;i<e.length;i++)e[i]^=t[3&i]}if(E.exports={concat:function(e,t){if(0===e.length)return L;if(1===e.length)return e[0];const i=Buffer.allocUnsafe(t);let r=0;for(let t=0;t<e.length;t++){const s=e[t];i.set(s,r),r+=s.length}return r<t?new C(i.buffer,i.byteOffset,r):i},mask:N,toArrayBuffer:function(e){return e.length===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.length)},toBuffer:function e(t){if(e.readOnly=!0,Buffer.isBuffer(t))return t;let i;return t instanceof ArrayBuffer?i=new C(t):ArrayBuffer.isView(t)?i=new C(t.buffer,t.byteOffset,t.byteLength):(i=Buffer.from(t),e.readOnly=!1),i},unmask:P},!process.env.WS_NO_BUFFER_UTIL)try{const e=require("bufferutil");E.exports.mask=function(t,i,r,s,o){o<48?N(t,i,r,s,o):e.mask(t,i,r,s,o)},E.exports.unmask=function(t,i){t.length<32?P(t,i):e.unmask(t,i)}}catch(e){}var B=E.exports;const R=Symbol("kDone"),U=Symbol("kRun");const A=n,I=B,W=class{constructor(e){this[R]=()=>{this.pending--,this[U]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[U]()}[U](){if(this.pending!==this.concurrency&&this.jobs.length){const e=this.jobs.shift();this.pending++,e(this[R])}}},{kStatusCode:M}=T,D=Buffer[Symbol.species],F=Buffer.from([0,0,255,255]),j=Symbol("permessage-deflate"),q=Symbol("total-length"),G=Symbol("callback"),z=Symbol("buffers"),K=Symbol("error");let V;var $=class{constructor(e,t,i){if(this._maxPayload=0|i,this._options=e||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,!V){const e=void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10;V=new W(e)}}static get extensionName(){return"permessage-deflate"}offer(){const e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){const e=this._deflate[G];this._deflate.close(),this._deflate=null,e&&e(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){const t=this._options,i=e.find((e=>!(!1===t.serverNoContextTakeover&&e.server_no_context_takeover||e.server_max_window_bits&&(!1===t.serverMaxWindowBits||"number"==typeof t.serverMaxWindowBits&&t.serverMaxWindowBits>e.server_max_window_bits)||"number"==typeof t.clientMaxWindowBits&&!e.client_max_window_bits)));if(!i)throw new Error("None of the extension offers can be accepted");return t.serverNoContextTakeover&&(i.server_no_context_takeover=!0),t.clientNoContextTakeover&&(i.client_no_context_takeover=!0),"number"==typeof t.serverMaxWindowBits&&(i.server_max_window_bits=t.serverMaxWindowBits),"number"==typeof t.clientMaxWindowBits?i.client_max_window_bits=t.clientMaxWindowBits:!0!==i.client_max_window_bits&&!1!==t.clientMaxWindowBits||delete i.client_max_window_bits,i}acceptAsClient(e){const t=e[0];if(!1===this._options.clientNoContextTakeover&&t.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(t.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(t.client_max_window_bits=this._options.clientMaxWindowBits);return t}normalizeParams(e){return e.forEach((e=>{Object.keys(e).forEach((t=>{let i=e[t];if(i.length>1)throw new Error(`Parameter "${t}" must have only a single value`);if(i=i[0],"client_max_window_bits"===t){if(!0!==i){const e=+i;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${i}`);i=e}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${t}": ${i}`)}else if("server_max_window_bits"===t){const e=+i;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${i}`);i=e}else{if("client_no_context_takeover"!==t&&"server_no_context_takeover"!==t)throw new Error(`Unknown parameter "${t}"`);if(!0!==i)throw new TypeError(`Invalid value for parameter "${t}": ${i}`)}e[t]=i}))})),e}decompress(e,t,i){V.add((r=>{this._decompress(e,t,((e,t)=>{r(),i(e,t)}))}))}compress(e,t,i){V.add((r=>{this._compress(e,t,((e,t)=>{r(),i(e,t)}))}))}_decompress(e,t,i){const r=this._isServer?"client":"server";if(!this._inflate){const e=`${r}_max_window_bits`,t="number"!=typeof this.params[e]?A.Z_DEFAULT_WINDOWBITS:this.params[e];this._inflate=A.createInflateRaw({...this._options.zlibInflateOptions,windowBits:t}),this._inflate[j]=this,this._inflate[q]=0,this._inflate[z]=[],this._inflate.on("error",X),this._inflate.on("data",Y)}this._inflate[G]=i,this._inflate.write(e),t&&this._inflate.write(F),this._inflate.flush((()=>{const e=this._inflate[K];if(e)return this._inflate.close(),this._inflate=null,void i(e);const s=I.concat(this._inflate[z],this._inflate[q]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[q]=0,this._inflate[z]=[],t&&this.params[`${r}_no_context_takeover`]&&this._inflate.reset()),i(null,s)}))}_compress(e,t,i){const r=this._isServer?"server":"client";if(!this._deflate){const e=`${r}_max_window_bits`,t="number"!=typeof this.params[e]?A.Z_DEFAULT_WINDOWBITS:this.params[e];this._deflate=A.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:t}),this._deflate[q]=0,this._deflate[z]=[],this._deflate.on("data",H)}this._deflate[G]=i,this._deflate.write(e),this._deflate.flush(A.Z_SYNC_FLUSH,(()=>{if(!this._deflate)return;let e=I.concat(this._deflate[z],this._deflate[q]);t&&(e=new D(e.buffer,e.byteOffset,e.length-4)),this._deflate[G]=null,this._deflate[q]=0,this._deflate[z]=[],t&&this.params[`${r}_no_context_takeover`]&&this._deflate.reset(),i(null,e)}))}};function H(e){this[z].push(e),this[q]+=e.length}function Y(e){this[q]+=e.length,this[j]._maxPayload<1||this[q]<=this[j]._maxPayload?this[z].push(e):(this[K]=new RangeError("Max payload size exceeded"),this[K].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[K][M]=1009,this.removeListener("data",Y),this.reset())}function X(e){this[j]._inflate=null,e[M]=1007,this[G](e)}var J={exports:{}};const{isUtf8:Z}=a,{hasBlob:Q}=T;function ee(e){const t=e.length;let i=0;for(;i<t;)if(128&e[i])if(192==(224&e[i])){if(i+1===t||128!=(192&e[i+1])||192==(254&e[i]))return!1;i+=2}else if(224==(240&e[i])){if(i+2>=t||128!=(192&e[i+1])||128!=(192&e[i+2])||224===e[i]&&128==(224&e[i+1])||237===e[i]&&160==(224&e[i+1]))return!1;i+=3}else{if(240!=(248&e[i]))return!1;if(i+3>=t||128!=(192&e[i+1])||128!=(192&e[i+2])||128!=(192&e[i+3])||240===e[i]&&128==(240&e[i+1])||244===e[i]&&e[i+1]>143||e[i]>244)return!1;i+=4}else i++;return!0}if(J.exports={isBlob:function(e){return Q&&"object"==typeof e&&"function"==typeof e.arrayBuffer&&"string"==typeof e.type&&"function"==typeof e.stream&&("Blob"===e[Symbol.toStringTag]||"File"===e[Symbol.toStringTag])},isValidStatusCode:function(e){return e>=1e3&&e<=1014&&1004!==e&&1005!==e&&1006!==e||e>=3e3&&e<=4999},isValidUTF8:ee,tokenChars:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0]},Z)J.exports.isValidUTF8=function(e){return e.length<24?ee(e):Z(e)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{const e=require("utf-8-validate");J.exports.isValidUTF8=function(t){return t.length<32?ee(t):e(t)}}catch(e){}var te=J.exports;const{Writable:ie}=o,re=$,{BINARY_TYPES:se,EMPTY_BUFFER:oe,kStatusCode:ne,kWebSocket:ae}=T,{concat:de,toArrayBuffer:he,unmask:le}=B,{isValidStatusCode:ce,isValidUTF8:ue}=te,fe=Buffer[Symbol.species];var me=class extends ie{constructor(e={}){super(),this._allowSynchronousEvents=void 0===e.allowSynchronousEvents||e.allowSynchronousEvents,this._binaryType=e.binaryType||se[0],this._extensions=e.extensions||{},this._isServer=!!e.isServer,this._maxPayload=0|e.maxPayload,this._skipUTF8Validation=!!e.skipUTF8Validation,this[ae]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._errored=!1,this._loop=!1,this._state=0}_write(e,t,i){if(8===this._opcode&&0==this._state)return i();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(i)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){const t=this._buffers[0];return this._buffers[0]=new fe(t.buffer,t.byteOffset+e,t.length-e),new fe(t.buffer,t.byteOffset,e)}const t=Buffer.allocUnsafe(e);do{const i=this._buffers[0],r=t.length-e;e>=i.length?t.set(this._buffers.shift(),r):(t.set(new Uint8Array(i.buffer,i.byteOffset,e),r),this._buffers[0]=new fe(i.buffer,i.byteOffset+e,i.length-e)),e-=i.length}while(e>0);return t}startLoop(e){this._loop=!0;do{switch(this._state){case 0:this.getInfo(e);break;case 1:this.getPayloadLength16(e);break;case 2:this.getPayloadLength64(e);break;case 3:this.getMask();break;case 4:this.getData(e);break;case 5:case 6:return void(this._loop=!1)}}while(this._loop);this._errored||e()}getInfo(e){if(this._bufferedBytes<2)return void(this._loop=!1);const t=this.consume(2);if(48&t[0]){return void e(this.createError(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3"))}const i=!(64&~t[0]);if(!i||this._extensions[re.extensionName]){if(this._fin=!(128&~t[0]),this._opcode=15&t[0],this._payloadLength=127&t[1],0===this._opcode){if(i){return void e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"))}if(!this._fragmented){return void e(this.createError(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE"))}this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented){return void e(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"))}this._compressed=i}else{if(!(this._opcode>7&&this._opcode<11)){return void e(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"))}if(!this._fin){return void e(this.createError(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN"))}if(i){return void e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"))}if(this._payloadLength>125||8===this._opcode&&1===this._payloadLength){return void e(this.createError(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH"))}}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=!(128&~t[1]),this._isServer){if(!this._masked){return void e(this.createError(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK"))}}else if(this._masked){return void e(this.createError(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK"))}126===this._payloadLength?this._state=1:127===this._payloadLength?this._state=2:this.haveLength(e)}else{e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"))}}getPayloadLength16(e){this._bufferedBytes<2?this._loop=!1:(this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength(e))}getPayloadLength64(e){if(this._bufferedBytes<8)return void(this._loop=!1);const t=this.consume(8),i=t.readUInt32BE(0);if(i>Math.pow(2,21)-1){e(this.createError(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH"))}else this._payloadLength=i*Math.pow(2,32)+t.readUInt32BE(4),this.haveLength(e)}haveLength(e){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0)){e(this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"))}else this._masked?this._state=3:this._state=4}getMask(){this._bufferedBytes<4?this._loop=!1:(this._mask=this.consume(4),this._state=4)}getData(e){let t=oe;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength)return void(this._loop=!1);t=this.consume(this._payloadLength),this._masked&&this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3]&&le(t,this._mask)}if(this._opcode>7)this.controlMessage(t,e);else{if(this._compressed)return this._state=5,void this.decompress(t,e);t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),this.dataMessage(e)}}decompress(e,t){this._extensions[re.extensionName].decompress(e,this._fin,((e,i)=>{if(e)return t(e);if(i.length){if(this._messageLength+=i.length,this._messageLength>this._maxPayload&&this._maxPayload>0){const e=this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");return void t(e)}this._fragments.push(i)}this.dataMessage(t),0===this._state&&this.startLoop(t)}))}dataMessage(e){if(!this._fin)return void(this._state=0);const t=this._messageLength,i=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){let r;r="nodebuffer"===this._binaryType?de(i,t):"arraybuffer"===this._binaryType?he(de(i,t)):"blob"===this._binaryType?new Blob(i):i,this._allowSynchronousEvents?(this.emit("message",r,!0),this._state=0):(this._state=6,setImmediate((()=>{this.emit("message",r,!0),this._state=0,this.startLoop(e)})))}else{const r=de(i,t);if(!this._skipUTF8Validation&&!ue(r)){const t=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");return void e(t)}5===this._state||this._allowSynchronousEvents?(this.emit("message",r,!1),this._state=0):(this._state=6,setImmediate((()=>{this.emit("message",r,!1),this._state=0,this.startLoop(e)})))}}controlMessage(e,t){if(8!==this._opcode)this._allowSynchronousEvents?(this.emit(9===this._opcode?"ping":"pong",e),this._state=0):(this._state=6,setImmediate((()=>{this.emit(9===this._opcode?"ping":"pong",e),this._state=0,this.startLoop(t)})));else{if(0===e.length)this._loop=!1,this.emit("conclude",1005,oe),this.end();else{const i=e.readUInt16BE(0);if(!ce(i)){const e=this.createError(RangeError,`invalid status code ${i}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");return void t(e)}const r=new fe(e.buffer,e.byteOffset+2,e.length-2);if(!this._skipUTF8Validation&&!ue(r)){const e=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");return void t(e)}this._loop=!1,this.emit("conclude",i,r),this.end()}this._state=0}}createError(e,t,i,r,s){this._loop=!1,this._errored=!0;const o=new e(i?`Invalid WebSocket frame: ${t}`:t);return Error.captureStackTrace(o,this.createError),o.code=s,o[ne]=r,o}};const{randomFillSync:pe}=d,_e=$,{EMPTY_BUFFER:ve,kWebSocket:ye,NOOP:ge}=T,{isBlob:be,isValidStatusCode:we}=te,{mask:ke,toBuffer:Se}=B,Ee=Symbol("kByteLength"),xe=Buffer.alloc(4),Oe=8192;let Te,Le=Oe;var Ce=class e{constructor(e,t,i){this._extensions=t||{},i&&(this._generateMask=i,this._maskBuffer=Buffer.alloc(4)),this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._queue=[],this._state=0,this.onerror=ge,this[ye]=void 0}static frame(e,t){let i,r,s=!1,o=2,n=!1;t.mask&&(i=t.maskBuffer||xe,t.generateMask?t.generateMask(i):(Le===Oe&&(void 0===Te&&(Te=Buffer.alloc(Oe)),pe(Te,0,Oe),Le=0),i[0]=Te[Le++],i[1]=Te[Le++],i[2]=Te[Le++],i[3]=Te[Le++]),n=!(i[0]|i[1]|i[2]|i[3]),o=6),"string"==typeof e?r=t.mask&&!n||void 0===t[Ee]?(e=Buffer.from(e)).length:t[Ee]:(r=e.length,s=t.mask&&t.readOnly&&!n);let a=r;r>=65536?(o+=8,a=127):r>125&&(o+=2,a=126);const d=Buffer.allocUnsafe(s?r+o:o);return d[0]=t.fin?128|t.opcode:t.opcode,t.rsv1&&(d[0]|=64),d[1]=a,126===a?d.writeUInt16BE(r,2):127===a&&(d[2]=d[3]=0,d.writeUIntBE(r,4,6)),t.mask?(d[1]|=128,d[o-4]=i[0],d[o-3]=i[1],d[o-2]=i[2],d[o-1]=i[3],n?[d,e]:s?(ke(e,i,d,o,r),[d]):(ke(e,i,e,0,r),[d,e])):[d,e]}close(t,i,r,s){let o;if(void 0===t)o=ve;else{if("number"!=typeof t||!we(t))throw new TypeError("First argument must be a valid error code number");if(void 0!==i&&i.length){const e=Buffer.byteLength(i);if(e>123)throw new RangeError("The message must not be greater than 123 bytes");o=Buffer.allocUnsafe(2+e),o.writeUInt16BE(t,0),"string"==typeof i?o.write(i,2):o.set(i,2)}else o=Buffer.allocUnsafe(2),o.writeUInt16BE(t,0)}const n={[Ee]:o.length,fin:!0,generateMask:this._generateMask,mask:r,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};0!==this._state?this.enqueue([this.dispatch,o,!1,n,s]):this.sendFrame(e.frame(o,n),s)}ping(t,i,r){let s,o;if("string"==typeof t?(s=Buffer.byteLength(t),o=!1):be(t)?(s=t.size,o=!1):(s=(t=Se(t)).length,o=Se.readOnly),s>125)throw new RangeError("The data size must not be greater than 125 bytes");const n={[Ee]:s,fin:!0,generateMask:this._generateMask,mask:i,maskBuffer:this._maskBuffer,opcode:9,readOnly:o,rsv1:!1};be(t)?0!==this._state?this.enqueue([this.getBlobData,t,!1,n,r]):this.getBlobData(t,!1,n,r):0!==this._state?this.enqueue([this.dispatch,t,!1,n,r]):this.sendFrame(e.frame(t,n),r)}pong(t,i,r){let s,o;if("string"==typeof t?(s=Buffer.byteLength(t),o=!1):be(t)?(s=t.size,o=!1):(s=(t=Se(t)).length,o=Se.readOnly),s>125)throw new RangeError("The data size must not be greater than 125 bytes");const n={[Ee]:s,fin:!0,generateMask:this._generateMask,mask:i,maskBuffer:this._maskBuffer,opcode:10,readOnly:o,rsv1:!1};be(t)?0!==this._state?this.enqueue([this.getBlobData,t,!1,n,r]):this.getBlobData(t,!1,n,r):0!==this._state?this.enqueue([this.dispatch,t,!1,n,r]):this.sendFrame(e.frame(t,n),r)}send(e,t,i){const r=this._extensions[_e.extensionName];let s,o,n=t.binary?2:1,a=t.compress;"string"==typeof e?(s=Buffer.byteLength(e),o=!1):be(e)?(s=e.size,o=!1):(s=(e=Se(e)).length,o=Se.readOnly),this._firstFragment?(this._firstFragment=!1,a&&r&&r.params[r._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(a=s>=r._threshold),this._compress=a):(a=!1,n=0),t.fin&&(this._firstFragment=!0);const d={[Ee]:s,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:n,readOnly:o,rsv1:a};be(e)?0!==this._state?this.enqueue([this.getBlobData,e,this._compress,d,i]):this.getBlobData(e,this._compress,d,i):0!==this._state?this.enqueue([this.dispatch,e,this._compress,d,i]):this.dispatch(e,this._compress,d,i)}getBlobData(t,i,r,s){this._bufferedBytes+=r[Ee],this._state=2,t.arrayBuffer().then((t=>{if(this._socket.destroyed){const e=new Error("The socket was closed while the blob was being read");return void process.nextTick(Ne,this,e,s)}this._bufferedBytes-=r[Ee];const o=Se(t);i?this.dispatch(o,i,r,s):(this._state=0,this.sendFrame(e.frame(o,r),s),this.dequeue())})).catch((e=>{process.nextTick(Pe,this,e,s)}))}dispatch(t,i,r,s){if(!i)return void this.sendFrame(e.frame(t,r),s);const o=this._extensions[_e.extensionName];this._bufferedBytes+=r[Ee],this._state=1,o.compress(t,r.fin,((t,i)=>{if(this._socket.destroyed){Ne(this,new Error("The socket was closed while data was being compressed"),s)}else this._bufferedBytes-=r[Ee],this._state=0,r.readOnly=!1,this.sendFrame(e.frame(i,r),s),this.dequeue()}))}dequeue(){for(;0===this._state&&this._queue.length;){const e=this._queue.shift();this._bufferedBytes-=e[3][Ee],Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[3][Ee],this._queue.push(e)}sendFrame(e,t){2===e.length?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],t),this._socket.uncork()):this._socket.write(e[0],t)}};function Ne(e,t,i){"function"==typeof i&&i(t);for(let i=0;i<e._queue.length;i++){const r=e._queue[i],s=r[r.length-1];"function"==typeof s&&s(t)}}function Pe(e,t,i){Ne(e,t,i),e.onerror(t)}const{kForOnEventAttribute:Be,kListener:Re}=T,Ue=Symbol("kCode"),Ae=Symbol("kData"),Ie=Symbol("kError"),We=Symbol("kMessage"),Me=Symbol("kReason"),De=Symbol("kTarget"),Fe=Symbol("kType"),je=Symbol("kWasClean");class qe{constructor(e){this[De]=null,this[Fe]=e}get target(){return this[De]}get type(){return this[Fe]}}Object.defineProperty(qe.prototype,"target",{enumerable:!0}),Object.defineProperty(qe.prototype,"type",{enumerable:!0});class Ge extends qe{constructor(e,t={}){super(e),this[Ue]=void 0===t.code?0:t.code,this[Me]=void 0===t.reason?"":t.reason,this[je]=void 0!==t.wasClean&&t.wasClean}get code(){return this[Ue]}get reason(){return this[Me]}get wasClean(){return this[je]}}Object.defineProperty(Ge.prototype,"code",{enumerable:!0}),Object.defineProperty(Ge.prototype,"reason",{enumerable:!0}),Object.defineProperty(Ge.prototype,"wasClean",{enumerable:!0});class ze extends qe{constructor(e,t={}){super(e),this[Ie]=void 0===t.error?null:t.error,this[We]=void 0===t.message?"":t.message}get error(){return this[Ie]}get message(){return this[We]}}Object.defineProperty(ze.prototype,"error",{enumerable:!0}),Object.defineProperty(ze.prototype,"message",{enumerable:!0});class Ke extends qe{constructor(e,t={}){super(e),this[Ae]=void 0===t.data?null:t.data}get data(){return this[Ae]}}Object.defineProperty(Ke.prototype,"data",{enumerable:!0});const Ve={addEventListener(e,t,i={}){for(const r of this.listeners(e))if(!i[Be]&&r[Re]===t&&!r[Be])return;let r;if("message"===e)r=function(e,i){const r=new Ke("message",{data:i?e:e.toString()});r[De]=this,He(t,this,r)};else if("close"===e)r=function(e,i){const r=new Ge("close",{code:e,reason:i.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});r[De]=this,He(t,this,r)};else if("error"===e)r=function(e){const i=new ze("error",{error:e,message:e.message});i[De]=this,He(t,this,i)};else{if("open"!==e)return;r=function(){const e=new qe("open");e[De]=this,He(t,this,e)}}r[Be]=!!i[Be],r[Re]=t,i.once?this.once(e,r):this.on(e,r)},removeEventListener(e,t){for(const i of this.listeners(e))if(i[Re]===t&&!i[Be]){this.removeListener(e,i);break}}};var $e={CloseEvent:Ge,ErrorEvent:ze,Event:qe,EventTarget:Ve,MessageEvent:Ke};function He(e,t,i){"object"==typeof e&&e.handleEvent?e.handleEvent.call(e,i):e.call(t,i)}const{tokenChars:Ye}=te;function Xe(e,t,i){void 0===e[t]?e[t]=[i]:e[t].push(i)}var Je={format:function(e){return Object.keys(e).map((t=>{let i=e[t];return Array.isArray(i)||(i=[i]),i.map((e=>[t].concat(Object.keys(e).map((t=>{let i=e[t];return Array.isArray(i)||(i=[i]),i.map((e=>!0===e?t:`${t}=${e}`)).join("; ")}))).join("; "))).join(", ")})).join(", ")},parse:function(e){const t=Object.create(null);let i,r,s=Object.create(null),o=!1,n=!1,a=!1,d=-1,h=-1,l=-1,c=0;for(;c<e.length;c++)if(h=e.charCodeAt(c),void 0===i)if(-1===l&&1===Ye[h])-1===d&&(d=c);else if(0===c||32!==h&&9!==h){if(59!==h&&44!==h)throw new SyntaxError(`Unexpected character at index ${c}`);{if(-1===d)throw new SyntaxError(`Unexpected character at index ${c}`);-1===l&&(l=c);const r=e.slice(d,l);44===h?(Xe(t,r,s),s=Object.create(null)):i=r,d=l=-1}}else-1===l&&-1!==d&&(l=c);else if(void 0===r)if(-1===l&&1===Ye[h])-1===d&&(d=c);else if(32===h||9===h)-1===l&&-1!==d&&(l=c);else if(59===h||44===h){if(-1===d)throw new SyntaxError(`Unexpected character at index ${c}`);-1===l&&(l=c),Xe(s,e.slice(d,l),!0),44===h&&(Xe(t,i,s),s=Object.create(null),i=void 0),d=l=-1}else{if(61!==h||-1===d||-1!==l)throw new SyntaxError(`Unexpected character at index ${c}`);r=e.slice(d,c),d=l=-1}else if(n){if(1!==Ye[h])throw new SyntaxError(`Unexpected character at index ${c}`);-1===d?d=c:o||(o=!0),n=!1}else if(a)if(1===Ye[h])-1===d&&(d=c);else if(34===h&&-1!==d)a=!1,l=c;else{if(92!==h)throw new SyntaxError(`Unexpected character at index ${c}`);n=!0}else if(34===h&&61===e.charCodeAt(c-1))a=!0;else if(-1===l&&1===Ye[h])-1===d&&(d=c);else if(-1===d||32!==h&&9!==h){if(59!==h&&44!==h)throw new SyntaxError(`Unexpected character at index ${c}`);{if(-1===d)throw new SyntaxError(`Unexpected character at index ${c}`);-1===l&&(l=c);let n=e.slice(d,l);o&&(n=n.replace(/\\/g,""),o=!1),Xe(s,r,n),44===h&&(Xe(t,i,s),s=Object.create(null),i=void 0),r=void 0,d=l=-1}}else-1===l&&(l=c);if(-1===d||a||32===h||9===h)throw new SyntaxError("Unexpected end of input");-1===l&&(l=c);const u=e.slice(d,l);return void 0===i?Xe(t,u,s):(void 0===r?Xe(s,u,!0):Xe(s,r,o?u.replace(/\\/g,""):u),Xe(t,i,s)),t}};const Ze=h,Qe=l,et=c,tt=u,it=f,{randomBytes:rt,createHash:st}=d,{URL:ot}=m,nt=$,at=me,dt=Ce,{isBlob:ht}=te,{BINARY_TYPES:lt,EMPTY_BUFFER:ct,GUID:ut,kForOnEventAttribute:ft,kListener:mt,kStatusCode:pt,kWebSocket:_t,NOOP:vt}=T,{EventTarget:{addEventListener:yt,removeEventListener:gt}}=$e,{format:bt,parse:wt}=Je,{toBuffer:kt}=B,St=3e4,Et=Symbol("kAborted"),xt=[8,13],Ot=["CONNECTING","OPEN","CLOSING","CLOSED"],Tt=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/;class Lt extends Ze{constructor(e,t,i){super(),this._binaryType=lt[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=ct,this._closeTimer=null,this._errorEmitted=!1,this._extensions={},this._paused=!1,this._protocol="",this._readyState=Lt.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,null!==e?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,void 0===t?t=[]:Array.isArray(t)||("object"==typeof t&&null!==t?(i=t,t=[]):t=[t]),Ct(this,e,t,i)):(this._autoPong=i.autoPong,this._isServer=!0)}get binaryType(){return this._binaryType}set binaryType(e){lt.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(e,t,i){const r=new at({allowSynchronousEvents:i.allowSynchronousEvents,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:i.maxPayload,skipUTF8Validation:i.skipUTF8Validation}),s=new dt(e,this._extensions,i.generateMask);this._receiver=r,this._sender=s,this._socket=e,r[_t]=this,s[_t]=this,e[_t]=this,r.on("conclude",At),r.on("drain",It),r.on("error",Wt),r.on("message",Dt),r.on("ping",Ft),r.on("pong",jt),s.onerror=Gt,e.setTimeout&&e.setTimeout(0),e.setNoDelay&&e.setNoDelay(),t.length>0&&e.unshift(t),e.on("close",Kt),e.on("data",Vt),e.on("end",$t),e.on("error",Ht),this._readyState=Lt.OPEN,this.emit("open")}emitClose(){if(!this._socket)return this._readyState=Lt.CLOSED,void this.emit("close",this._closeCode,this._closeMessage);this._extensions[nt.extensionName]&&this._extensions[nt.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=Lt.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,t){if(this.readyState!==Lt.CLOSED)if(this.readyState!==Lt.CONNECTING)this.readyState!==Lt.CLOSING?(this._readyState=Lt.CLOSING,this._sender.close(e,t,!this._isServer,(e=>{e||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())})),zt(this)):this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();else{const e="WebSocket was closed before the connection was established";Rt(this,this._req,e)}}pause(){this.readyState!==Lt.CONNECTING&&this.readyState!==Lt.CLOSED&&(this._paused=!0,this._socket.pause())}ping(e,t,i){if(this.readyState===Lt.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(i=e,e=t=void 0):"function"==typeof t&&(i=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===Lt.OPEN?(void 0===t&&(t=!this._isServer),this._sender.ping(e||ct,t,i)):Ut(this,e,i)}pong(e,t,i){if(this.readyState===Lt.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(i=e,e=t=void 0):"function"==typeof t&&(i=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===Lt.OPEN?(void 0===t&&(t=!this._isServer),this._sender.pong(e||ct,t,i)):Ut(this,e,i)}resume(){this.readyState!==Lt.CONNECTING&&this.readyState!==Lt.CLOSED&&(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(e,t,i){if(this.readyState===Lt.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof t&&(i=t,t={}),"number"==typeof e&&(e=e.toString()),this.readyState!==Lt.OPEN)return void Ut(this,e,i);const r={binary:"string"!=typeof e,mask:!this._isServer,compress:!0,fin:!0,...t};this._extensions[nt.extensionName]||(r.compress=!1),this._sender.send(e||ct,r,i)}terminate(){if(this.readyState!==Lt.CLOSED)if(this.readyState!==Lt.CONNECTING)this._socket&&(this._readyState=Lt.CLOSING,this._socket.destroy());else{const e="WebSocket was closed before the connection was established";Rt(this,this._req,e)}}}function Ct(e,t,i,r){const s={allowSynchronousEvents:!0,autoPong:!0,protocolVersion:xt[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...r,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(e._autoPong=s.autoPong,!xt.includes(s.protocolVersion))throw new RangeError(`Unsupported protocol version: ${s.protocolVersion} (supported versions: ${xt.join(", ")})`);let o;if(t instanceof ot)o=t;else try{o=new ot(t)}catch(e){throw new SyntaxError(`Invalid URL: ${t}`)}"http:"===o.protocol?o.protocol="ws:":"https:"===o.protocol&&(o.protocol="wss:"),e._url=o.href;const n="wss:"===o.protocol,a="ws+unix:"===o.protocol;let d;if("ws:"===o.protocol||n||a?a&&!o.pathname?d="The URL's pathname is empty":o.hash&&(d="The URL contains a fragment identifier"):d='The URL\'s protocol must be one of "ws:", "wss:", "http:", "https", or "ws+unix:"',d){const t=new SyntaxError(d);if(0===e._redirects)throw t;return void Nt(e,t)}const h=n?443:80,l=rt(16).toString("base64"),c=n?Qe.request:et.request,u=new Set;let f,m;if(s.createConnection=s.createConnection||(n?Bt:Pt),s.defaultPort=s.defaultPort||h,s.port=o.port||h,s.host=o.hostname.startsWith("[")?o.hostname.slice(1,-1):o.hostname,s.headers={...s.headers,"Sec-WebSocket-Version":s.protocolVersion,"Sec-WebSocket-Key":l,Connection:"Upgrade",Upgrade:"websocket"},s.path=o.pathname+o.search,s.timeout=s.handshakeTimeout,s.perMessageDeflate&&(f=new nt(!0!==s.perMessageDeflate?s.perMessageDeflate:{},!1,s.maxPayload),s.headers["Sec-WebSocket-Extensions"]=bt({[nt.extensionName]:f.offer()})),i.length){for(const e of i){if("string"!=typeof e||!Tt.test(e)||u.has(e))throw new SyntaxError("An invalid or duplicated subprotocol was specified");u.add(e)}s.headers["Sec-WebSocket-Protocol"]=i.join(",")}if(s.origin&&(s.protocolVersion<13?s.headers["Sec-WebSocket-Origin"]=s.origin:s.headers.Origin=s.origin),(o.username||o.password)&&(s.auth=`${o.username}:${o.password}`),a){const e=s.path.split(":");s.socketPath=e[0],s.path=e[1]}if(s.followRedirects){if(0===e._redirects){e._originalIpc=a,e._originalSecure=n,e._originalHostOrSocketPath=a?s.socketPath:o.host;const t=r&&r.headers;if(r={...r,headers:{}},t)for(const[e,i]of Object.entries(t))r.headers[e.toLowerCase()]=i}else if(0===e.listenerCount("redirect")){const t=a?!!e._originalIpc&&s.socketPath===e._originalHostOrSocketPath:!e._originalIpc&&o.host===e._originalHostOrSocketPath;(!t||e._originalSecure&&!n)&&(delete s.headers.authorization,delete s.headers.cookie,t||delete s.headers.host,s.auth=void 0)}s.auth&&!r.headers.authorization&&(r.headers.authorization="Basic "+Buffer.from(s.auth).toString("base64")),m=e._req=c(s),e._redirects&&e.emit("redirect",e.url,m)}else m=e._req=c(s);s.timeout&&m.on("timeout",(()=>{Rt(e,m,"Opening handshake has timed out")})),m.on("error",(t=>{null===m||m[Et]||(m=e._req=null,Nt(e,t))})),m.on("response",(o=>{const n=o.headers.location,a=o.statusCode;if(n&&s.followRedirects&&a>=300&&a<400){if(++e._redirects>s.maxRedirects)return void Rt(e,m,"Maximum redirects exceeded");let o;m.abort();try{o=new ot(n,t)}catch(t){const i=new SyntaxError(`Invalid URL: ${n}`);return void Nt(e,i)}Ct(e,o,i,r)}else e.emit("unexpected-response",m,o)||Rt(e,m,`Unexpected server response: ${o.statusCode}`)})),m.on("upgrade",((t,i,r)=>{if(e.emit("upgrade",t),e.readyState!==Lt.CONNECTING)return;m=e._req=null;const o=t.headers.upgrade;if(void 0===o||"websocket"!==o.toLowerCase())return void Rt(e,i,"Invalid Upgrade header");const n=st("sha1").update(l+ut).digest("base64");if(t.headers["sec-websocket-accept"]!==n)return void Rt(e,i,"Invalid Sec-WebSocket-Accept header");const a=t.headers["sec-websocket-protocol"];let d;if(void 0!==a?u.size?u.has(a)||(d="Server sent an invalid subprotocol"):d="Server sent a subprotocol but none was requested":u.size&&(d="Server sent no subprotocol"),d)return void Rt(e,i,d);a&&(e._protocol=a);const h=t.headers["sec-websocket-extensions"];if(void 0!==h){if(!f){return void Rt(e,i,"Server sent a Sec-WebSocket-Extensions header but no extension was requested")}let t;try{t=wt(h)}catch(t){return void Rt(e,i,"Invalid Sec-WebSocket-Extensions header")}const r=Object.keys(t);if(1!==r.length||r[0]!==nt.extensionName){return void Rt(e,i,"Server indicated an extension that was not requested")}try{f.accept(t[nt.extensionName])}catch(t){return void Rt(e,i,"Invalid Sec-WebSocket-Extensions header")}e._extensions[nt.extensionName]=f}e.setSocket(i,r,{allowSynchronousEvents:s.allowSynchronousEvents,generateMask:s.generateMask,maxPayload:s.maxPayload,skipUTF8Validation:s.skipUTF8Validation})})),s.finishRequest?s.finishRequest(m,e):m.end()}function Nt(e,t){e._readyState=Lt.CLOSING,e._errorEmitted=!0,e.emit("error",t),e.emitClose()}function Pt(e){return e.path=e.socketPath,tt.connect(e)}function Bt(e){return e.path=void 0,e.servername||""===e.servername||(e.servername=tt.isIP(e.host)?"":e.host),it.connect(e)}function Rt(e,t,i){e._readyState=Lt.CLOSING;const r=new Error(i);Error.captureStackTrace(r,Rt),t.setHeader?(t[Et]=!0,t.abort(),t.socket&&!t.socket.destroyed&&t.socket.destroy(),process.nextTick(Nt,e,r)):(t.destroy(r),t.once("error",e.emit.bind(e,"error")),t.once("close",e.emitClose.bind(e)))}function Ut(e,t,i){if(t){const i=ht(t)?t.size:kt(t).length;e._socket?e._sender._bufferedBytes+=i:e._bufferedAmount+=i}if(i){const t=new Error(`WebSocket is not open: readyState ${e.readyState} (${Ot[e.readyState]})`);process.nextTick(i,t)}}function At(e,t){const i=this[_t];i._closeFrameReceived=!0,i._closeMessage=t,i._closeCode=e,void 0!==i._socket[_t]&&(i._socket.removeListener("data",Vt),process.nextTick(qt,i._socket),1005===e?i.close():i.close(e,t))}function It(){const e=this[_t];e.isPaused||e._socket.resume()}function Wt(e){const t=this[_t];void 0!==t._socket[_t]&&(t._socket.removeListener("data",Vt),process.nextTick(qt,t._socket),t.close(e[pt])),t._errorEmitted||(t._errorEmitted=!0,t.emit("error",e))}function Mt(){this[_t].emitClose()}function Dt(e,t){this[_t].emit("message",e,t)}function Ft(e){const t=this[_t];t._autoPong&&t.pong(e,!this._isServer,vt),t.emit("ping",e)}function jt(e){this[_t].emit("pong",e)}function qt(e){e.resume()}function Gt(e){const t=this[_t];t.readyState!==Lt.CLOSED&&(t.readyState===Lt.OPEN&&(t._readyState=Lt.CLOSING,zt(t)),this._socket.end(),t._errorEmitted||(t._errorEmitted=!0,t.emit("error",e)))}function zt(e){e._closeTimer=setTimeout(e._socket.destroy.bind(e._socket),St)}function Kt(){const e=this[_t];let t;this.removeListener("close",Kt),this.removeListener("data",Vt),this.removeListener("end",$t),e._readyState=Lt.CLOSING,this._readableState.endEmitted||e._closeFrameReceived||e._receiver._writableState.errorEmitted||null===(t=e._socket.read())||e._receiver.write(t),e._receiver.end(),this[_t]=void 0,clearTimeout(e._closeTimer),e._receiver._writableState.finished||e._receiver._writableState.errorEmitted?e.emitClose():(e._receiver.on("error",Mt),e._receiver.on("finish",Mt))}function Vt(e){this[_t]._receiver.write(e)||this.pause()}function $t(){const e=this[_t];e._readyState=Lt.CLOSING,e._receiver.end(),this.end()}function Ht(){const e=this[_t];this.removeListener("error",Ht),this.on("error",vt),e&&(e._readyState=Lt.CLOSING,this.destroy())}Object.defineProperty(Lt,"CONNECTING",{enumerable:!0,value:Ot.indexOf("CONNECTING")}),Object.defineProperty(Lt.prototype,"CONNECTING",{enumerable:!0,value:Ot.indexOf("CONNECTING")}),Object.defineProperty(Lt,"OPEN",{enumerable:!0,value:Ot.indexOf("OPEN")}),Object.defineProperty(Lt.prototype,"OPEN",{enumerable:!0,value:Ot.indexOf("OPEN")}),Object.defineProperty(Lt,"CLOSING",{enumerable:!0,value:Ot.indexOf("CLOSING")}),Object.defineProperty(Lt.prototype,"CLOSING",{enumerable:!0,value:Ot.indexOf("CLOSING")}),Object.defineProperty(Lt,"CLOSED",{enumerable:!0,value:Ot.indexOf("CLOSED")}),Object.defineProperty(Lt.prototype,"CLOSED",{enumerable:!0,value:Ot.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach((e=>{Object.defineProperty(Lt.prototype,e,{enumerable:!0})})),["open","error","close","message"].forEach((e=>{Object.defineProperty(Lt.prototype,`on${e}`,{enumerable:!0,get(){for(const t of this.listeners(e))if(t[ft])return t[mt];return null},set(t){for(const t of this.listeners(e))if(t[ft]){this.removeListener(e,t);break}"function"==typeof t&&this.addEventListener(e,t,{[ft]:!0})}})})),Lt.prototype.addEventListener=yt,Lt.prototype.removeEventListener=gt;var Yt=S(Lt);
/**
 * Scraped By Kaviaann
 * Protected By MIT LICENSE
 * Whoever caught removing wm will be sued
 * @description Any Request? Contact me : vielynian@gmail.com
 * @author Kaviaann 2024
 * @copyright https://whatsapp.com/channel/0029Vac0YNgAjPXNKPXCvE2e
 */var Xt=Object.freeze({__proto__:null,englishAi:function(){return v(this,arguments,void 0,(function*(e=[{content:"you are vielyn, your goal is to help the user about their problems",role:"user"},{content:"hi! what can i help you today?⭐",role:"assistant",refusal:null},{content:"what is your name?",role:"user"}]){return new Promise(((t,r)=>v(this,void 0,void 0,(function*(){var s;try{if(!e||!Array.isArray(e)||e.length<1)return r(Error("Enter valid chat object [ IEnglishAiChat ]"));const o=yield i.post("https://api.deepenglish.com/api/gpt/chat",{messages:e,temperature:.9},{headers:{Origin:"https://members.deepenglish.com",Referer:"https://members.deepenglish.com/",Host:"api.deepenglish.com","User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36"}}).then((e=>e.data)),n=e;return yield n.push(yield o.data.choices.shift().message),yield t({history:[...n],response:(yield null===(s=n.pop())||void 0===s?void 0:s.content)||""})}catch(e){r(e)}}))))}))},fluxGen:function(e){return v(this,void 0,void 0,(function*(){return new Promise(((t,i)=>v(this,void 0,void 0,(function*(){try{const s=e=>new Promise((e=>setTimeout(e,5e3))),o=new Yt("wss://ws-api.runware.ai/v1"),n={},a=[];return o.on("open",(()=>v(this,void 0,void 0,(function*(){for(o.on("message",((e,t)=>{const i=JSON.parse(Buffer.from(e).toString("utf8")).data[0];"authentication"===i.taskType&&(n.uuid=i.connectionSessionUUID),"imageInference"===i.taskType&&a.push({isNSFW:i.NSFWContent,imageURI:i.imageDataURI,imageURL:i.imageURL})})),o.send(JSON.stringify([{apiKey:"z1ilk4CqKMMMPSm3gynSdrsuoKsECcxK",taskType:"authentication"}]),(e=>{if(e)return i(new Error("Fail to init authentication!"))}));!n.uuid;)yield s(1e3);for(o.send(JSON.stringify([{taskType:"imageInference",model:"runware:100@1",positivePrompt:e,height:512,width:512,numberResults:2,outputType:["dataURI","URL"],outputFormat:"WEBP",taskUUID:r.randomUUID()}]),(e=>{if(e)return i(new Error("Fail to send image request"))})),setTimeout((()=>{!a.length&&i(new Error("Timeout making images!"))}),15e3);!a.length;)yield s(2500);return t({prompt:e,total:a.length,images:a})})))),o}catch(e){return i(e)}}))))}))}}),Jt=Object.freeze({__proto__:null,Ai:Xt,Anime:b,Downloader:k,Tools:w});var Zt=Object.freeze({__proto__:null,delay:function(e){return v(this,void 0,void 0,(function*(){return new Promise((t=>v(this,void 0,void 0,(function*(){setTimeout((()=>t()),e)}))))}))},generateId:function(e){return v(this,void 0,void 0,(function*(){const t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890+=";let i="",r=0;for(;r<e;)i+=t[Math.floor(64*Math.random())],r++;return i}))}});exports.Function=Zt,exports.Scraper=Jt;
//# sourceMappingURL=index.cjs.map
